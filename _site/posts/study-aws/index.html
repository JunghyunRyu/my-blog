<!doctype html> <!-- `site.alt_lang` can specify a language different from the UI --> <html lang="ko-KR" > <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"> <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"> <meta name="mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"> <meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><!-- Setup Open Graph image --> <!-- Begin Jekyll SEO tag v2.8.0 --> <meta name="generator" content="Jekyll v4.4.1" /> <meta property="og:title" content="AWS EC2 FastAPI 프로덕션 배포 완전 가이드" /> <meta property="og:locale" content="ko_KR" /> <meta name="description" content="AWS EC2에서 FastAPI 애플리케이션을 프로덕션 수준으로 배포하는 완전한 기술 레퍼런스" /> <meta property="og:description" content="AWS EC2에서 FastAPI 애플리케이션을 프로덕션 수준으로 배포하는 완전한 기술 레퍼런스" /> <link rel="canonical" href="http://localhost:4000/my-blog/posts/study-aws/" /> <meta property="og:url" content="http://localhost:4000/my-blog/posts/study-aws/" /> <meta property="og:site_name" content="정현류의 개발 블로그" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2025-10-11T19:30:00+09:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="AWS EC2 FastAPI 프로덕션 배포 완전 가이드" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-11T19:30:00+09:00","datePublished":"2025-10-11T19:30:00+09:00","description":"AWS EC2에서 FastAPI 애플리케이션을 프로덕션 수준으로 배포하는 완전한 기술 레퍼런스","headline":"AWS EC2 FastAPI 프로덕션 배포 완전 가이드","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/my-blog/posts/study-aws/"},"url":"http://localhost:4000/my-blog/posts/study-aws/"}</script> <!-- End Jekyll SEO tag --> <title>AWS EC2 FastAPI 프로덕션 배포 완전 가이드 | 정현류의 개발 블로그 </title> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://realfavicongenerator.net/ --> <link rel="apple-touch-icon" sizes="180x180" href="/my-blog/assets/img/favicons/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/my-blog/assets/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/my-blog/assets/img/favicons/favicon-16x16.png"> <link rel="shortcut icon" href="/my-blog/assets/img/favicons/favicon.ico"> <meta name="apple-mobile-web-app-title" content="정현류의 개발 블로그"> <meta name="application-name" content="정현류의 개발 블로그"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/my-blog/assets/img/favicons/browserconfig.xml"> <meta name="theme-color" content="#ffffff"> <!-- Resource Hints --> <link rel="preconnect" href="https://fonts.googleapis.com" > <link rel="dns-prefetch" href="https://fonts.googleapis.com" > <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link rel="dns-prefetch" href="https://fonts.gstatic.com" > <link rel="preconnect" href="https://cdn.jsdelivr.net" > <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" > <!-- Bootstrap --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"> <!-- Theme style --> <link rel="stylesheet" href="/my-blog/assets/css/jekyll-theme-chirpy.css"> <!-- Web Font --> <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"> <!-- Font Awesome Icons --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"> <!-- 3rd-party Dependencies --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"> <!-- Image Popup --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <!-- Scripts --> <script src="/my-blog/assets/js/dist/theme.min.js"></script> <!-- JS selector for site. --> <!-- commons --> <!-- layout specified --> <!-- image lazy-loading & popup & clipboard --> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/ko.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/my-blog/assets/js/dist/post.min.js"></script> <!-- Pageviews --> <!-- A placeholder to allow defining custom metadata --> </head> <body> <!-- The Side Bar --> <aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"> <header class="profile-wrapper"> <a href="/my-blog/" id="avatar" class="rounded-circle"><img src="/my-blog/assets/img/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/my-blog/">정현류의 개발 블로그</a> <p class="site-subtitle fst-italic mb-0">QA Engineer, Learner, Writer</p> </header> <!-- .profile-wrapper --> <nav class="flex-column flex-grow-1 w-100 ps-0"> <ul class="nav"> <!-- home --> <li class="nav-item"> <a href="/my-blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>홈</span> </a> </li> <!-- the real tabs --> <li class="nav-item"> <a href="/my-blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>카테고리</span> </a> </li> <!-- .nav-item --> <li class="nav-item"> <a href="/my-blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>정보</span> </a> </li> <!-- .nav-item --> </ul> </nav> <div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/junghyunryu" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/my-blog/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> </div> <!-- .sidebar-bottom --> </aside> <!-- #sidebar --> <div id="main-wrapper" class="d-flex justify-content-center"> <div class="container d-flex flex-column px-xxl-5"> <!-- The Top Bar --> <header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"> <div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" > <nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/my-blog/">홈</a> </span> <span>AWS EC2 FastAPI 프로덕션 배포 완전 가이드</span> </nav> <!-- endof #breadcrumb --> <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button> <div id="topbar-title"> 포스트 </div> <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">취소</button> </div> </header> <div class="row flex-grow-1"> <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"> <!-- Refactor the HTML structure --> <!-- In order to allow a wide table to scroll horizontally, we suround the markdown table with `<div class="table-wrapper">` and `</div>` --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --> <!-- Change the icon of checkbox --> <!-- Handle images --> <!-- Add header for code snippets --> <!-- Create heading anchors --> <!-- return --> <article class="px-1" data-toc="true"> <header> <h1 data-toc-skip>AWS EC2 FastAPI 프로덕션 배포 완전 가이드</h1> <p class="post-desc fw-light mb-4">AWS EC2에서 FastAPI 애플리케이션을 프로덕션 수준으로 배포하는 완전한 기술 레퍼런스</p> <div class="post-meta text-muted"> <!-- published date --> <span> 게시 <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <time data-ts="1760178600" data-df="YYYY/MM/DD" data-bs-toggle="tooltip" data-bs-placement="bottom" > 2025/10/11 </time> </span> <!-- lastmod date --> <div class="d-flex justify-content-between"> <!-- author(s) --> <span> By <em> <a href="https://github.com/junghyunryu">정현류</a> </em> </span> <div> <!-- pageviews --> <!-- read time --> <!-- Calculate the post's reading time, and display the word count in tooltip --> <!-- words per minute --> <!-- return element --> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="9939 단어" > <em>55 분</em>읽는 시간</span> </div> </div> </div> </header> <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">AWS EC2 FastAPI 프로덕션 배포 완전 가이드</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button> </div> <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">바로가기</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"> <div class="header d-flex flex-row align-items-center justify-content-between"> <div class="label text-truncate py-2 ms-4">AWS EC2 FastAPI 프로덕션 배포 완전 가이드</div> <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button> </div> <div id="toc-popup-content" class="px-4 py-3 pb-4"></div> </dialog> <div class="content"> <h1 id="aws-ec2-fastapi-프로덕션-배포-완전-가이드">AWS EC2 FastAPI 프로덕션 배포 완전 가이드</h1> <h2 id="개요"><span class="me-2">개요</span><a href="#개요" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>본 문서는 AWS EC2 Ubuntu 환경에서 FastAPI 애플리케이션을 프로덕션 수준으로 배포하기 위한 종합적인 기술 레퍼런스입니다.</p> <p>기본적인 서버 구축부터 시작하여, systemd를 통한 프로세스 관리, Nginx 리버스 프록시 구성, HTTPS 인증서 설정, 보안 강화, 성능 최적화, 모니터링 및 로깅까지 프로덕션 환경에 필요한 모든 측면을 다룹니다.</p> <p><strong>주요 다루는 내용:</strong></p> <ul> <li>EC2 인스턴스 설정 및 네트워크 보안 구성</li> <li>Python 가상환경 및 FastAPI 애플리케이션 구성</li> <li>systemd를 통한 서비스 자동화 및 프로세스 관리</li> <li>Nginx 리버스 프록시 설정 및 최적화</li> <li>Let’s Encrypt를 통한 무료 SSL/TLS 인증서 발급</li> <li>UFW 방화벽 및 Fail2ban을 통한 보안 강화</li> <li>로그 관리, 디버깅 및 트러블슈팅</li> <li>성능 최적화 및 모니터링 전략</li> </ul> <hr /> <h2 id="목차"><span class="me-2">목차</span><a href="#목차" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <ol> <li><a href="#사전-요구사항">사전 요구사항</a></li> <li><a href="#환경-준비">환경 준비</a></li> <li><a href="#python-및-필수-패키지-설치">Python 및 필수 패키지 설치</a></li> <li><a href="#프로젝트-디렉터리-구성">프로젝트 디렉터리 구성</a></li> <li><a href="#가상환경-구성-및-fastapi-설치">가상환경 구성 및 FastAPI 설치</a></li> <li><a href="#fastapi-애플리케이션-코드">FastAPI 애플리케이션 코드</a></li> <li><a href="#서버-실행-테스트">서버 실행 테스트</a></li> <li><a href="#aws-보안-그룹-설정">AWS 보안 그룹 설정</a></li> <li><a href="#systemd를-통한-자동-실행-설정">systemd를 통한 자동 실행 설정</a></li> <li><a href="#환경-변수-관리">환경 변수 관리</a></li> <li><a href="#로그-관리-및-디버깅">로그 관리 및 디버깅</a></li> <li><a href="#nginx-리버스-프록시-설정">Nginx 리버스 프록시 설정</a></li> <li><a href="#https-설정-lets-encrypt">HTTPS 설정 (Let’s Encrypt)</a></li> <li><a href="#보안-강화">보안 강화</a></li> <li><a href="#성능-최적화">성능 최적화</a></li> <li><a href="#모니터링-및-유지보수">모니터링 및 유지보수</a></li> <li><a href="#vscode-sftp-설정">VSCode SFTP 설정</a></li> <li><a href="#트러블슈팅">트러블슈팅</a></li> <li><a href="#참고-자료">참고 자료</a></li> </ol> <hr /> <h2 id="사전-요구사항"><span class="me-2">사전 요구사항</span><a href="#사전-요구사항" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="시스템-요구사항"><span class="me-2">시스템 요구사항</span><a href="#시스템-요구사항" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>AWS 리소스:</strong></p> <ul> <li>EC2 인스턴스 (최소 t2.micro, 권장 t2.small 이상)</li> <li>탄력적 IP 주소 (Elastic IP) - 프로덕션 환경 권장</li> <li>보안 그룹 설정 권한</li> </ul> <p><strong>로컬 환경:</strong></p> <ul> <li>SSH 클라이언트 (Windows: PowerShell/PuTTY, macOS/Linux: 터미널)</li> <li>PEM 키 파일</li> <li>VSCode (선택사항, 배포 자동화용)</li> </ul> <p><strong>소프트웨어 버전:</strong></p> <ul> <li>Ubuntu 24.04.2 LTS (또는 22.04 LTS)</li> <li>Python 3.10 이상 (권장: 3.11+)</li> <li>FastAPI 0.100.0 이상</li> <li>Uvicorn 0.23.0 이상</li> <li>Nginx 1.18.0 이상 (리버스 프록시 사용 시)</li> </ul> <p><strong>네트워크 지식:</strong></p> <ul> <li>TCP/IP 기본 개념</li> <li>HTTP/HTTPS 프로토콜</li> <li>DNS 기본 개념 (도메인 사용 시)</li> </ul> <p><strong>보안 지식:</strong></p> <ul> <li>SSH 키 기반 인증</li> <li>방화벽 기본 개념</li> <li>SSL/TLS 인증서 개념</li> </ul> <h3 id="아키텍처-개요"><span class="me-2">아키텍처 개요</span><a href="#아키텍처-개요" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>프로덕션 환경에서의 FastAPI 배포 아키텍처:</p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>인터넷
  ↓
[AWS 보안 그룹] → 포트 80, 443 허용
  ↓
[Nginx 리버스 프록시] → 포트 80/443
  ↓
[Uvicorn (FastAPI)] → 포트 8000 (로컬)
  ↓
[systemd] → 프로세스 관리 및 자동 재시작
</pre></td></tr></tbody></table></code></div></div> <p><strong>주요 구성 요소:</strong></p> <ul> <li><strong>Nginx</strong>: 정적 파일 서빙, SSL 종료, 로드 밸런싱, 보안 헤더</li> <li><strong>Uvicorn</strong>: ASGI 서버, FastAPI 애플리케이션 실행</li> <li><strong>systemd</strong>: 서비스 자동 시작, 재시작, 로그 관리</li> <li><strong>UFW</strong>: 호스트 기반 방화벽</li> <li><strong>Let’s Encrypt</strong>: 무료 SSL/TLS 인증서</li> </ul> <hr /> <h2 id="환경-준비"><span class="me-2">환경 준비</span><a href="#환경-준비" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="ec2-인스턴스-생성"><span class="me-2">EC2 인스턴스 생성</span><a href="#ec2-인스턴스-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>인스턴스 스펙 선택:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>AMI: Ubuntu Server 24.04.2 LTS (HVM), SSD Volume Type
인스턴스 유형: t2.micro (프리티어) 또는 t2.small (권장)
스토리지: 최소 8GB (권장 20GB 이상)
</pre></td></tr></tbody></table></code></div></div> <p><strong>인스턴스 생성 과정:</strong></p> <ol> <li>AWS Console → EC2 → 인스턴스 시작</li> <li>Ubuntu 24.04.2 LTS AMI 선택</li> <li>인스턴스 유형 선택 (CPU, 메모리 고려)</li> <li>키 페어 생성/선택 (.pem 파일 다운로드 및 안전하게 보관)</li> <li>네트워크 설정 - 나중에 보안 그룹 구성</li> <li>스토리지 구성 - 최소 8GB gp3 볼륨</li> <li>고급 세부 정보 - IAM 역할 필요 시 설정</li> </ol> <p><strong>Elastic IP 할당 (프로덕션 권장):</strong></p> <p>고정 IP 주소가 필요한 경우:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># AWS Console에서</span>
EC2 → 탄력적 IP → 주소 할당 → 인스턴스에 연결
</pre></td></tr></tbody></table></code></div></div> <p>이를 통해 인스턴스 재시작 시에도 동일한 IP 주소를 유지할 수 있습니다.</p> <h3 id="ec2-인스턴스-접속"><span class="me-2">EC2 인스턴스 접속</span><a href="#ec2-인스턴스-접속" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>SSH 키 권한 설정 (최초 1회):</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c"># Linux/macOS</span>
<span class="nb">chmod </span>400 /경로/열쇠파일.pem

<span class="c"># Windows PowerShell</span>
icacls <span class="s2">"C:</span><span class="se">\경</span><span class="s2">로</span><span class="se">\열</span><span class="s2">쇠파일.pem"</span> /inheritance:r
icacls <span class="s2">"C:</span><span class="se">\경</span><span class="s2">로</span><span class="se">\열</span><span class="s2">쇠파일.pem"</span> /grant:r <span class="s2">"%USERNAME%:R"</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>SSH 접속:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>ssh <span class="nt">-i</span> /경로/열쇠파일.pem ubuntu@인스턴스IP

<span class="c"># 예시 (Linux/macOS)</span>
ssh <span class="nt">-i</span> /Users/pem/my_proton_key.pem ubuntu@13.124.216.216

<span class="c"># 예시 (Windows)</span>
ssh <span class="nt">-i</span> C:<span class="se">\U</span>sers<span class="se">\m</span>y<span class="se">\p</span>em<span class="se">\m</span>y_proton_key.pem ubuntu@13.124.216.216
</pre></td></tr></tbody></table></code></div></div> <p><strong>SSH 접속 간소화 (.ssh/config 설정):</strong></p> <p>로컬 머신의 <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> 파일에 다음 내용 추가:</p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>Host aws-fastapi
    HostName 13.124.216.216
    User ubuntu
    IdentityFile /경로/열쇠파일.pem
    ServerAliveInterval 60
</pre></td></tr></tbody></table></code></div></div> <p>이제 <code class="language-plaintext highlighter-rouge">ssh aws-fastapi</code>만으로 접속 가능합니다.</p> <h3 id="초기-시스템-업데이트"><span class="me-2">초기 시스템 업데이트</span><a href="#초기-시스템-업데이트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>인스턴스 접속 후 시스템 업데이트를 진행합니다:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt upgrade <span class="nt">-y</span>
<span class="nb">sudo </span>apt autoremove <span class="nt">-y</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>시스템 시간대 설정:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 현재 시간대 확인</span>
timedatectl

<span class="c"># 서울 시간대로 설정</span>
<span class="nb">sudo </span>timedatectl set-timezone Asia/Seoul

<span class="c"># 확인</span>
timedatectl
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="python-및-필수-패키지-설치"><span class="me-2">Python 및 필수 패키지 설치</span><a href="#python-및-필수-패키지-설치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="python-설치-및-버전-확인"><span class="me-2">Python 설치 및 버전 확인</span><a href="#python-설치-및-버전-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>Ubuntu 24.04 LTS는 Python 3.12가 기본 설치되어 있습니다:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c"># Python 버전 확인</span>
python3 <span class="nt">--version</span>

<span class="c"># 출력 예: Python 3.12.3</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="필수-개발-도구-설치"><span class="me-2">필수 개발 도구 설치</span><a href="#필수-개발-도구-설치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> <span class="se">\</span>
    python3 <span class="se">\</span>
    python3-venv <span class="se">\</span>
    python3-pip <span class="se">\</span>
    python3-dev <span class="se">\</span>
    build-essential <span class="se">\</span>
    libssl-dev <span class="se">\</span>
    libffi-dev <span class="se">\</span>
    git <span class="se">\</span>
    curl <span class="se">\</span>
    wget
</pre></td></tr></tbody></table></code></div></div> <p><strong>패키지 설명:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">python3-venv</code>: 가상환경 생성 도구</li> <li><code class="language-plaintext highlighter-rouge">python3-pip</code>: Python 패키지 관리자</li> <li><code class="language-plaintext highlighter-rouge">python3-dev</code>: Python C 확장 컴파일용 헤더</li> <li><code class="language-plaintext highlighter-rouge">build-essential</code>: C/C++ 컴파일러 및 make</li> <li><code class="language-plaintext highlighter-rouge">libssl-dev</code>, <code class="language-plaintext highlighter-rouge">libffi-dev</code>: 암호화 라이브러리 의존성</li> <li><code class="language-plaintext highlighter-rouge">git</code>: 버전 관리 (코드 배포 시 유용)</li> <li><code class="language-plaintext highlighter-rouge">curl</code>, <code class="language-plaintext highlighter-rouge">wget</code>: HTTP 클라이언트 도구</li> </ul> <h3 id="pip-업그레이드"><span class="me-2">pip 업그레이드</span><a href="#pip-업그레이드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">--upgrade</span> pip
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="프로젝트-디렉터리-구성"><span class="me-2">프로젝트 디렉터리 구성</span><a href="#프로젝트-디렉터리-구성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="디렉터리-생성"><span class="me-2">디렉터리 생성</span><a href="#디렉터리-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> ~
<span class="nb">mkdir</span> <span class="nt">-p</span> reactbase/public
<span class="nb">cd </span>reactbase
</pre></td></tr></tbody></table></code></div></div> <h3 id="프로젝트-구조"><span class="me-2">프로젝트 구조</span><a href="#프로젝트-구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>프로덕션 환경에서 권장하는 디렉터리 구조:</p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>/home/ubuntu/reactbase/
├── venv/                # 가상환경
├── server.py            # FastAPI 애플리케이션
├── .env                 # 환경 변수 (민감 정보)
├── requirements.txt     # Python 의존성
├── public/              # 정적 파일 (이미지, CSS, JS 등)
│   ├── images/
│   ├── css/
│   └── js/
├── logs/                # 애플리케이션 로그 (선택사항)
└── tests/               # 테스트 코드 (선택사항)
</pre></td></tr></tbody></table></code></div></div> <h3 id="디렉터리-권한-설정"><span class="me-2">디렉터리 권한 설정</span><a href="#디렉터리-권한-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 현재 사용자 소유로 설정</span>
<span class="nb">sudo chown</span> <span class="nt">-R</span> ubuntu:ubuntu /home/ubuntu/reactbase

<span class="c"># 디렉터리 권한 설정 (755)</span>
<span class="nb">chmod </span>755 /home/ubuntu/reactbase

<span class="c"># 정적 파일 디렉터리</span>
<span class="nb">chmod </span>755 /home/ubuntu/reactbase/public
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="가상환경-구성-및-fastapi-설치"><span class="me-2">가상환경 구성 및 FastAPI 설치</span><a href="#가상환경-구성-및-fastapi-설치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="가상환경-생성-및-활성화"><span class="me-2">가상환경 생성 및 활성화</span><a href="#가상환경-생성-및-활성화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 가상환경 생성</span>
python3 <span class="nt">-m</span> venv venv

<span class="c"># 가상환경 활성화</span>
<span class="nb">source </span>venv/bin/activate

<span class="c"># 활성화 확인 - 프롬프트 앞에 (venv) 표시</span>
<span class="o">(</span>venv<span class="o">)</span> ubuntu@ip-xxx:~/reactbase<span class="err">$</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>가상환경 사용 이유:</strong></p> <ul> <li>시스템 Python과 프로젝트 의존성 분리</li> <li>프로젝트별 독립적인 패키지 버전 관리</li> <li>권한 문제 방지 (sudo 없이 패키지 설치 가능)</li> </ul> <h3 id="fastapi-및-필수-패키지-설치"><span class="me-2">FastAPI 및 필수 패키지 설치</span><a href="#fastapi-및-필수-패키지-설치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># 기본 패키지 설치</span>
pip <span class="nb">install </span>fastapi uvicorn[standard]

<span class="c"># 추가 유용한 패키지</span>
pip <span class="nb">install</span> <span class="se">\</span>
    python-dotenv <span class="se">\</span>
    pydantic[email] <span class="se">\</span>
    python-multipart <span class="se">\</span>
    aiofiles
</pre></td></tr></tbody></table></code></div></div> <p><strong>패키지 설명:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">fastapi</code>: 웹 프레임워크</li> <li><code class="language-plaintext highlighter-rouge">uvicorn[standard]</code>: ASGI 서버 (HTTP/WebSocket 지원, 성능 최적화 포함)</li> <li><code class="language-plaintext highlighter-rouge">python-dotenv</code>: .env 파일에서 환경 변수 로드</li> <li><code class="language-plaintext highlighter-rouge">pydantic[email]</code>: 데이터 검증 (이메일 검증 포함)</li> <li><code class="language-plaintext highlighter-rouge">python-multipart</code>: 파일 업로드 지원</li> <li><code class="language-plaintext highlighter-rouge">aiofiles</code>: 비동기 파일 I/O</li> </ul> <h3 id="requirementstxt-생성"><span class="me-2">requirements.txt 생성</span><a href="#requirementstxt-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>의존성 관리를 위해 설치된 패키지 목록을 저장:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pip freeze <span class="o">&gt;</span> requirements.txt
</pre></td></tr></tbody></table></code></div></div> <p><strong>requirements.txt 내용 예시:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>fastapi==0.109.0
uvicorn[standard]==0.27.0
python-dotenv==1.0.0
pydantic[email]==2.5.0
python-multipart==0.0.6
aiofiles==23.2.1
</pre></td></tr></tbody></table></code></div></div> <h3 id="가상환경-비활성화"><span class="me-2">가상환경 비활성화</span><a href="#가상환경-비활성화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>작업 완료 후 가상환경 종료:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>deactivate
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="fastapi-애플리케이션-코드"><span class="me-2">FastAPI 애플리케이션 코드</span><a href="#fastapi-애플리케이션-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="기본-serverpy"><span class="me-2">기본 server.py</span><a href="#기본-serverpy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><code class="language-plaintext highlighter-rouge">/home/ubuntu/reactbase/server.py</code> 파일 생성:</p> <div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">fastapi.responses</span> <span class="kn">import</span> <span class="n">PlainTextResponse</span><span class="p">,</span> <span class="n">JSONResponse</span>
<span class="kn">from</span> <span class="nn">fastapi.staticfiles</span> <span class="kn">import</span> <span class="n">StaticFiles</span>
<span class="kn">from</span> <span class="nn">fastapi.middleware.cors</span> <span class="kn">import</span> <span class="n">CORSMiddleware</span>
<span class="kn">from</span> <span class="nn">fastapi.middleware.trustedhost</span> <span class="kn">import</span> <span class="n">TrustedHostMiddleware</span>
<span class="kn">import</span> <span class="nn">uvicorn</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># 환경 변수 로드 (선택사항)
</span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="n">load_dotenv</span><span class="p">()</span>

<span class="c1"># FastAPI 앱 초기화
</span><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s">"FastAPI Production Server"</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s">"AWS EC2에 배포된 프로덕션 FastAPI 서버"</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s">"1.0.0"</span><span class="p">,</span>
    <span class="n">docs_url</span><span class="o">=</span><span class="s">"/docs"</span><span class="p">,</span>  <span class="c1"># Swagger UI
</span>    <span class="n">redoc_url</span><span class="o">=</span><span class="s">"/redoc"</span>  <span class="c1"># ReDoc
</span><span class="p">)</span>

<span class="c1"># CORS 설정 (필요한 경우)
</span><span class="n">app</span><span class="p">.</span><span class="n">add_middleware</span><span class="p">(</span>
    <span class="n">CORSMiddleware</span><span class="p">,</span>
    <span class="n">allow_origins</span><span class="o">=</span><span class="p">[</span><span class="s">"*"</span><span class="p">],</span>  <span class="c1"># 프로덕션에서는 특정 도메인만 허용
</span>    <span class="n">allow_credentials</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">allow_methods</span><span class="o">=</span><span class="p">[</span><span class="s">"*"</span><span class="p">],</span>
    <span class="n">allow_headers</span><span class="o">=</span><span class="p">[</span><span class="s">"*"</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># 신뢰할 수 있는 호스트 설정 (보안)
# app.add_middleware(
#     TrustedHostMiddleware,
#     allowed_hosts=["yourdomain.com", "www.yourdomain.com"]
# )
</span>
<span class="c1"># 헬스 체크 엔드포인트
</span><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/health"</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">JSONResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">health_check</span><span class="p">():</span>
    <span class="s">"""서버 상태 확인용 헬스 체크 엔드포인트"""</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">"status"</span><span class="p">:</span> <span class="s">"healthy"</span><span class="p">,</span>
        <span class="s">"timestamp"</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">utcnow</span><span class="p">().</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="s">"version"</span><span class="p">:</span> <span class="s">"1.0.0"</span>
    <span class="p">}</span>

<span class="c1"># 기본 엔드포인트
</span><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">PlainTextResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">read_root</span><span class="p">():</span>
    <span class="s">"""루트 경로"""</span>
    <span class="k">return</span> <span class="s">"Welcome to FastAPI Production Server"</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/hello"</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">PlainTextResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">read_hello</span><span class="p">():</span>
    <span class="s">"""Hello 엔드포인트"""</span>
    <span class="k">return</span> <span class="s">"hello"</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/world"</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">PlainTextResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">read_world</span><span class="p">():</span>
    <span class="s">"""World 엔드포인트"""</span>
    <span class="k">return</span> <span class="s">"world"</span>

<span class="c1"># API 엔드포인트 예시
</span><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/api/info"</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">JSONResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">api_info</span><span class="p">():</span>
    <span class="s">"""서버 정보 반환"""</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">"server"</span><span class="p">:</span> <span class="s">"FastAPI"</span><span class="p">,</span>
        <span class="s">"python_version"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">sys</span><span class="p">.</span><span class="n">version</span><span class="p">,</span>
        <span class="s">"environment"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">"ENVIRONMENT"</span><span class="p">,</span> <span class="s">"production"</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># 정적 파일 서빙
</span><span class="n">static_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="p">.</span><span class="n">Path</span><span class="p">(</span><span class="n">__file__</span><span class="p">).</span><span class="n">resolve</span><span class="p">().</span><span class="n">parent</span>
<span class="n">public_dir</span> <span class="o">=</span> <span class="n">static_dir</span> <span class="o">/</span> <span class="s">"public"</span>

<span class="k">if</span> <span class="n">public_dir</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
<span class="n">app</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">"/images"</span><span class="p">,</span> <span class="n">StaticFiles</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">public_dir</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"images"</span><span class="p">)</span>
    <span class="n">app</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">"/static"</span><span class="p">,</span> <span class="n">StaticFiles</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">public_dir</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"static"</span><span class="p">)</span>

<span class="c1"># 에러 핸들러
</span><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">exception_handler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">not_found_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">,</span> <span class="n">exc</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span>
        <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
        <span class="n">content</span><span class="o">=</span><span class="p">{</span><span class="s">"detail"</span><span class="p">:</span> <span class="s">"요청한 리소스를 찾을 수 없습니다."</span><span class="p">}</span>
    <span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">exception_handler</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">internal_error_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">,</span> <span class="n">exc</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span>
        <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">content</span><span class="o">=</span><span class="p">{</span><span class="s">"detail"</span><span class="p">:</span> <span class="s">"서버 내부 오류가 발생했습니다."</span><span class="p">}</span>
    <span class="p">)</span>

<span class="c1"># 애플리케이션 시작/종료 이벤트
</span><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">on_event</span><span class="p">(</span><span class="s">"startup"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">startup_event</span><span class="p">():</span>
    <span class="s">"""앱 시작 시 실행"""</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"FastAPI 서버 시작됨"</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">on_event</span><span class="p">(</span><span class="s">"shutdown"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">shutdown_event</span><span class="p">():</span>
    <span class="s">"""앱 종료 시 실행"""</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"FastAPI 서버 종료됨"</span><span class="p">)</span>

<span class="c1"># 직접 실행 시 (개발 환경용)
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">uvicorn</span><span class="p">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">app</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="s">"0.0.0.0"</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span>
        <span class="n">log_level</span><span class="o">=</span><span class="s">"info"</span>
    <span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="파일-생성-방법"><span class="me-2">파일 생성 방법</span><a href="#파일-생성-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> /home/ubuntu/reactbase
nano server.py
<span class="c"># 위 코드를 복사 붙여넣기</span>
<span class="c"># Ctrl+O (저장), Ctrl+X (종료)</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="코드-주요-특징"><span class="me-2">코드 주요 특징</span><a href="#코드-주요-특징" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>프로덕션 준비:</strong></p> <ul> <li>헬스 체크 엔드포인트 (<code class="language-plaintext highlighter-rouge">/health</code>)</li> <li>CORS 미들웨어 설정</li> <li>에러 핸들러 구현</li> <li>시작/종료 이벤트 핸들러</li> </ul> <p><strong>보안:</strong></p> <ul> <li>TrustedHostMiddleware 옵션 (필요 시 활성화)</li> <li>환경 변수를 통한 설정 관리</li> </ul> <p><strong>문서화:</strong></p> <ul> <li>Swagger UI (<code class="language-plaintext highlighter-rouge">/docs</code>)</li> <li>ReDoc (<code class="language-plaintext highlighter-rouge">/redoc</code>)</li> </ul> <hr /> <h2 id="서버-실행-테스트"><span class="me-2">서버 실행 테스트</span><a href="#서버-실행-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="개발-모드로-서버-실행"><span class="me-2">개발 모드로 서버 실행</span><a href="#개발-모드로-서버-실행" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>가상환경 활성화 후 FastAPI 서버를 테스트 실행합니다:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> /home/ubuntu/reactbase
<span class="nb">source </span>venv/bin/activate
python3 server.py
</pre></td></tr></tbody></table></code></div></div> <p><strong>또는 uvicorn 직접 실행:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>uvicorn server:app <span class="nt">--host</span> 0.0.0.0 <span class="nt">--port</span> 8000
</pre></td></tr></tbody></table></code></div></div> <p><strong>개발 모드 (자동 리로드 활성화):</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>uvicorn server:app <span class="nt">--host</span> 0.0.0.0 <span class="nt">--port</span> 8000 <span class="nt">--reload</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="정상-실행-확인"><span class="me-2">정상 실행 확인</span><a href="#정상-실행-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>콘솔에 다음과 같은 로그가 출력되면 정상입니다:</p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>INFO:     Started server process [12345]
INFO:     Waiting for application startup.
FastAPI 서버 시작됨
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
</pre></td></tr></tbody></table></code></div></div> <h3 id="로컬에서-테스트"><span class="me-2">로컬에서 테스트</span><a href="#로컬에서-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>SSH 세션 내에서 curl로 테스트:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c"># 새 터미널 열기 (또는 서버를 백그라운드로 실행)</span>
curl http://localhost:8000/
<span class="c"># 출력: Welcome to FastAPI Production Server</span>

curl http://localhost:8000/health
<span class="c"># 출력: {"status":"healthy","timestamp":"...","version":"1.0.0"}</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="외부에서-접속-테스트"><span class="me-2">외부에서 접속 테스트</span><a href="#외부에서-접속-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>브라우저 또는 로컬 터미널에서:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>http://인스턴스_퍼블릭IP:8000
http://인스턴스_퍼블릭IP:8000/docs  <span class="c"># Swagger UI</span>
http://인스턴스_퍼블릭IP:8000/health
</pre></td></tr></tbody></table></code></div></div> <p><strong>접속이 안 된다면:</strong></p> <ol> <li>AWS 보안 그룹에서 8000 포트가 열려있는지 확인</li> <li>UFW 방화벽 확인 (설정한 경우)</li> <li>로컬 네트워크 방화벽 확인</li> </ol> <h3 id="서버-중지"><span class="me-2">서버 중지</span><a href="#서버-중지" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c"># Ctrl+C로 중지</span>
<span class="c"># 또는 프로세스 찾아서 종료</span>
ps aux | <span class="nb">grep </span>uvicorn
<span class="nb">kill</span> &lt;PID&gt;
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="aws-보안-그룹-설정"><span class="me-2">AWS 보안 그룹 설정</span><a href="#aws-보안-그룹-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>AWS 보안 그룹은 EC2 인스턴스의 가상 방화벽 역할을 합니다. 외부에서 서버에 접근하려면 필요한 포트를 열어야 합니다.</p> <h3 id="보안-그룹-인바운드-규칙-설정"><span class="me-2">보안 그룹 인바운드 규칙 설정</span><a href="#보안-그룹-인바운드-규칙-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>AWS Console에서 설정:</strong></p> <ol> <li>EC2 Dashboard → 인스턴스 선택</li> <li>보안 탭 → 보안 그룹 클릭</li> <li>인바운드 규칙 편집</li> </ol> <p><strong>필수 규칙:</strong></p> <div class="table-wrapper"><table> <thead> <tr> <th>유형</th> <th>프로토콜</th> <th>포트 범위</th> <th>소스</th> <th>설명</th> </tr> </thead> <tbody> <tr> <td>SSH</td> <td>TCP</td> <td>22</td> <td>My IP 또는 특정 IP</td> <td>SSH 접속</td> </tr> <tr> <td>사용자 지정 TCP</td> <td>TCP</td> <td>8000</td> <td>0.0.0.0/0</td> <td>FastAPI 직접 접근 (개발)</td> </tr> <tr> <td>HTTP</td> <td>TCP</td> <td>80</td> <td>0.0.0.0/0</td> <td>Nginx HTTP</td> </tr> <tr> <td>HTTPS</td> <td>TCP</td> <td>443</td> <td>0.0.0.0/0</td> <td>Nginx HTTPS</td> </tr> </tbody> </table></div> <p><strong>보안 권장사항:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>개발 단계: 8000 포트 개방 (0.0.0.0/0)
프로덕션 단계: 8000 포트 차단, 80/443만 개방
  → Nginx를 통해서만 FastAPI 접근 허용
</pre></td></tr></tbody></table></code></div></div> <h3 id="ip-화이트리스트-설정-선택사항"><span class="me-2">IP 화이트리스트 설정 (선택사항)</span><a href="#ip-화이트리스트-설정-선택사항" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>SSH 접근을 특정 IP로 제한:</p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>유형: SSH
프로토콜: TCP
포트: 22
소스: 123.456.789.0/32 (귀하의 고정 IP)
설명: Office IP only
</pre></td></tr></tbody></table></code></div></div> <h3 id="아웃바운드-규칙-확인"><span class="me-2">아웃바운드 규칙 확인</span><a href="#아웃바운드-규칙-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>기본적으로 모든 아웃바운드 트래픽이 허용되어 있습니다. 보안 강화가 필요한 경우 다음만 허용:</p> <div class="table-wrapper"><table> <thead> <tr> <th>유형</th> <th>프로토콜</th> <th>포트 범위</th> <th>대상</th> <th>설명</th> </tr> </thead> <tbody> <tr> <td>HTTP</td> <td>TCP</td> <td>80</td> <td>0.0.0.0/0</td> <td>패키지 다운로드</td> </tr> <tr> <td>HTTPS</td> <td>TCP</td> <td>443</td> <td>0.0.0.0/0</td> <td>보안 통신</td> </tr> <tr> <td>DNS (UDP)</td> <td>UDP</td> <td>53</td> <td>0.0.0.0/0</td> <td>DNS 조회</td> </tr> </tbody> </table></div> <h3 id="최소-권한-원칙"><span class="me-2">최소 권한 원칙</span><a href="#최소-권한-원칙" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>프로덕션 환경에서는 다음 원칙을 따릅니다:</p> <ol> <li><strong>SSH는 신뢰할 수 있는 IP만 허용</strong></li> <li><strong>애플리케이션 포트(8000)는 로컬호스트만 접근</strong> (Nginx 사용 시)</li> <li><strong>80/443 포트만 인터넷에 개방</strong></li> <li><strong>불필요한 포트는 모두 차단</strong></li> </ol> <h3 id="cli로-보안-그룹-설정"><span class="me-2">CLI로 보안 그룹 설정</span><a href="#cli로-보안-그룹-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>AWS CLI를 사용하는 경우:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># 보안 그룹 ID 확인</span>
aws ec2 describe-security-groups

<span class="c"># 인바운드 규칙 추가 (포트 8000)</span>
aws ec2 authorize-security-group-ingress <span class="se">\</span>
    <span class="nt">--group-id</span> sg-xxxxxxxxx <span class="se">\</span>
    <span class="nt">--protocol</span> tcp <span class="se">\</span>
    <span class="nt">--port</span> 8000 <span class="se">\</span>
    <span class="nt">--cidr</span> 0.0.0.0/0
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="systemd를-통한-자동-실행-설정"><span class="me-2">systemd를 통한 자동 실행 설정</span><a href="#systemd를-통한-자동-실행-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>systemd는 Linux 시스템의 서비스 관리자로, 프로세스의 시작, 중지, 재시작 및 자동 실행을 관리합니다.</p> <h3 id="systemd-서비스-파일-생성"><span class="me-2">systemd 서비스 파일 생성</span><a href="#systemd-서비스-파일-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><code class="language-plaintext highlighter-rouge">/etc/systemd/system/fastapi.service</code> 파일을 생성합니다:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/systemd/system/fastapi.service
</pre></td></tr></tbody></table></code></div></div> <p><strong>기본 설정:</strong></p> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="nn">[Unit]</span>
<span class="py">Description</span><span class="p">=</span><span class="s">FastAPI Application Server</span>
<span class="py">After</span><span class="p">=</span><span class="s">network.target</span>
<span class="py">Documentation</span><span class="p">=</span><span class="s">https://fastapi.tiangolo.com/</span>

<span class="nn">[Service]</span>
<span class="py">Type</span><span class="p">=</span><span class="s">notify</span>
<span class="py">User</span><span class="p">=</span><span class="s">ubuntu</span>
<span class="py">Group</span><span class="p">=</span><span class="s">ubuntu</span>
<span class="py">WorkingDirectory</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase</span>
<span class="py">Environment</span><span class="p">=</span><span class="s">"PATH=/home/ubuntu/reactbase/venv/bin"</span>
<span class="py">EnvironmentFile</span><span class="p">=</span><span class="s">-/home/ubuntu/reactbase/.env</span>
<span class="py">ExecStart</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase/venv/bin/uvicorn server:app --host 0.0.0.0 --port 8000</span>
<span class="py">ExecReload</span><span class="p">=</span><span class="s">/bin/kill -HUP $MAINPID</span>
<span class="py">Restart</span><span class="p">=</span><span class="s">always</span>
<span class="py">RestartSec</span><span class="p">=</span><span class="s">3</span>
<span class="py">StandardOutput</span><span class="p">=</span><span class="s">append:/var/log/fastapi/access.log</span>
<span class="py">StandardError</span><span class="p">=</span><span class="s">append:/var/log/fastapi/error.log</span>

<span class="c"># 보안 설정
</span><span class="py">NoNewPrivileges</span><span class="p">=</span><span class="s">true</span>
<span class="py">PrivateTmp</span><span class="p">=</span><span class="s">true</span>

<span class="c"># 리소스 제한
</span><span class="py">LimitNOFILE</span><span class="p">=</span><span class="s">65536</span>
<span class="py">TimeoutStopSec</span><span class="p">=</span><span class="s">30</span>

<span class="nn">[Install]</span>
<span class="py">WantedBy</span><span class="p">=</span><span class="s">multi-user.target</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>프로덕션 설정 (Multi-worker):</strong></p> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre><span class="nn">[Unit]</span>
<span class="py">Description</span><span class="p">=</span><span class="s">FastAPI Application Server (Production)</span>
<span class="py">After</span><span class="p">=</span><span class="s">network.target</span>
<span class="py">Documentation</span><span class="p">=</span><span class="s">https://fastapi.tiangolo.com/</span>

<span class="nn">[Service]</span>
<span class="py">Type</span><span class="p">=</span><span class="s">notify</span>
<span class="py">User</span><span class="p">=</span><span class="s">ubuntu</span>
<span class="py">Group</span><span class="p">=</span><span class="s">ubuntu</span>
<span class="py">WorkingDirectory</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase</span>
<span class="py">Environment</span><span class="p">=</span><span class="s">"PATH=/home/ubuntu/reactbase/venv/bin"</span>
<span class="py">EnvironmentFile</span><span class="p">=</span><span class="s">-/home/ubuntu/reactbase/.env</span>
<span class="py">ExecStart</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase/venv/bin/uvicorn server:app </span><span class="se">\
</span>    <span class="s">--host 0.0.0.0 </span><span class="se">\
</span>    <span class="s">--port 8000 </span><span class="se">\
</span>    <span class="s">--workers 4 </span><span class="se">\
</span>    <span class="s">--log-level info </span><span class="se">\
</span>    <span class="s">--access-log </span><span class="se">\
</span>    <span class="s">--proxy-headers </span><span class="se">\
</span>    <span class="s">--forwarded-allow-ips='*'</span>
<span class="py">ExecReload</span><span class="p">=</span><span class="s">/bin/kill -HUP $MAINPID</span>
<span class="py">Restart</span><span class="p">=</span><span class="s">on-failure</span>
<span class="py">RestartSec</span><span class="p">=</span><span class="s">5s</span>
<span class="py">StandardOutput</span><span class="p">=</span><span class="s">journal</span>
<span class="py">StandardError</span><span class="p">=</span><span class="s">journal</span>
<span class="py">SyslogIdentifier</span><span class="p">=</span><span class="s">fastapi</span>

<span class="c"># 보안 강화
</span><span class="py">NoNewPrivileges</span><span class="p">=</span><span class="s">true</span>
<span class="py">PrivateTmp</span><span class="p">=</span><span class="s">true</span>
<span class="py">ProtectSystem</span><span class="p">=</span><span class="s">strict</span>
<span class="py">ProtectHome</span><span class="p">=</span><span class="s">read-only</span>
<span class="py">ReadWritePaths</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase</span>

<span class="c"># 리소스 제한
</span><span class="py">LimitNOFILE</span><span class="p">=</span><span class="s">65536</span>
<span class="py">LimitNPROC</span><span class="p">=</span><span class="s">512</span>

<span class="nn">[Install]</span>
<span class="py">WantedBy</span><span class="p">=</span><span class="s">multi-user.target</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="서비스-파일-옵션-설명"><span class="me-2">서비스 파일 옵션 설명</span><a href="#서비스-파일-옵션-설명" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>[Unit] 섹션:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">Description</code>: 서비스 설명</li> <li><code class="language-plaintext highlighter-rouge">After</code>: 네트워크가 준비된 후 시작</li> <li><code class="language-plaintext highlighter-rouge">Documentation</code>: 문서 URL</li> </ul> <p><strong>[Service] 섹션:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">Type=notify</code>: systemd에 시작 완료 알림</li> <li><code class="language-plaintext highlighter-rouge">User/Group</code>: 실행 사용자/그룹</li> <li><code class="language-plaintext highlighter-rouge">WorkingDirectory</code>: 작업 디렉터리</li> <li><code class="language-plaintext highlighter-rouge">Environment</code>: 환경 변수 설정</li> <li><code class="language-plaintext highlighter-rouge">EnvironmentFile</code>: .env 파일 로드 (-는 파일 없어도 에러 안남)</li> <li><code class="language-plaintext highlighter-rouge">ExecStart</code>: 실행 명령어</li> <li><code class="language-plaintext highlighter-rouge">ExecReload</code>: 리로드 명령어 (HUP 시그널)</li> <li><code class="language-plaintext highlighter-rouge">Restart=always</code>: 항상 재시작 (on-failure는 실패 시만)</li> <li><code class="language-plaintext highlighter-rouge">RestartSec</code>: 재시작 대기 시간</li> <li><code class="language-plaintext highlighter-rouge">StandardOutput/StandardError</code>: 로그 출력 위치</li> </ul> <p><strong>보안 옵션:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">NoNewPrivileges</code>: 권한 상승 방지</li> <li><code class="language-plaintext highlighter-rouge">PrivateTmp</code>: 독립적인 /tmp 사용</li> <li><code class="language-plaintext highlighter-rouge">ProtectSystem</code>: 시스템 디렉터리 보호</li> <li><code class="language-plaintext highlighter-rouge">ProtectHome</code>: 홈 디렉터리 보호</li> </ul> <p><strong>리소스 제한:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">LimitNOFILE</code>: 파일 디스크립터 제한</li> <li><code class="language-plaintext highlighter-rouge">LimitNPROC</code>: 프로세스 수 제한</li> </ul> <h3 id="worker-수-계산"><span class="me-2">Worker 수 계산</span><a href="#worker-수-계산" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>CPU 코어 기반 권장 worker 수:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># CPU 코어 수 확인</span>
<span class="nb">nproc</span>

<span class="c"># 권장 worker 수 = (CPU 코어 수 × 2) + 1</span>
<span class="c"># 예: 2 코어 → (2 × 2) + 1 = 5 workers</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="로그-디렉터리-생성"><span class="me-2">로그 디렉터리 생성</span><a href="#로그-디렉터리-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>StandardOutput/StandardError에 파일 로그를 사용하는 경우:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /var/log/fastapi
<span class="nb">sudo chown </span>ubuntu:ubuntu /var/log/fastapi
<span class="nb">sudo chmod </span>755 /var/log/fastapi
</pre></td></tr></tbody></table></code></div></div> <hr /> <h3 id="systemd-서비스-등록-및-활성화"><span class="me-2">systemd 서비스 등록 및 활성화</span><a href="#systemd-서비스-등록-및-활성화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>서비스 등록 단계:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># 1. systemd에 새 서비스 파일 인식</span>
<span class="nb">sudo </span>systemctl daemon-reload

<span class="c"># 2. 부팅 시 자동 시작 활성화</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>fastapi.service

<span class="c"># 3. 서비스 즉시 시작</span>
<span class="nb">sudo </span>systemctl start fastapi.service

<span class="c"># 4. 서비스 상태 확인</span>
<span class="nb">sudo </span>systemctl status fastapi.service
</pre></td></tr></tbody></table></code></div></div> <p><strong>정상 실행 시 출력:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>● fastapi.service - FastAPI Application Server
     Loaded: loaded (/etc/systemd/system/fastapi.service; enabled; vendor preset: enabled)
     Active: active (running) since Fri 2025-10-11 10:30:00 KST; 5s ago
       Docs: https://fastapi.tiangolo.com/
   Main PID: 12345 (uvicorn)
      Tasks: 5 (limit: 4915)
     Memory: 50.2M
     CGroup: /system.slice/fastapi.service
             ├─12345 /home/ubuntu/reactbase/venv/bin/python3 /home/ubuntu/reactbase/venv/bin/uvicorn...
             ├─12346 /home/ubuntu/reactbase/venv/bin/python3 -c from multiprocessing.resource_tracker...
             └─12347 /home/ubuntu/reactbase/venv/bin/python3 -c from multiprocessing.spawn import...

Oct 11 10:30:00 systemd[1]: Started FastAPI Application Server.
Oct 11 10:30:00 uvicorn[12345]: INFO:     Started server process [12345]
Oct 11 10:30:00 uvicorn[12345]: INFO:     Waiting for application startup.
Oct 11 10:30:00 uvicorn[12345]: INFO:     Application startup complete.
Oct 11 10:30:00 uvicorn[12345]: INFO:     Uvicorn running on http://0.0.0.0:8000
</pre></td></tr></tbody></table></code></div></div> <h3 id="systemd-서비스-관리-명령어"><span class="me-2">systemd 서비스 관리 명령어</span><a href="#systemd-서비스-관리-명령어" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>상태 확인:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 서비스 상태</span>
<span class="nb">sudo </span>systemctl status fastapi.service

<span class="c"># 실행 여부만 확인</span>
<span class="nb">sudo </span>systemctl is-active fastapi.service

<span class="c"># 자동 시작 활성화 여부</span>
<span class="nb">sudo </span>systemctl is-enabled fastapi.service
</pre></td></tr></tbody></table></code></div></div> <p><strong>서비스 제어:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c"># 서비스 시작</span>
<span class="nb">sudo </span>systemctl start fastapi.service

<span class="c"># 서비스 중지</span>
<span class="nb">sudo </span>systemctl stop fastapi.service

<span class="c"># 서비스 재시작</span>
<span class="nb">sudo </span>systemctl restart fastapi.service

<span class="c"># 서비스 리로드 (다운타임 없이)</span>
<span class="nb">sudo </span>systemctl reload fastapi.service

<span class="c"># 부팅 시 자동 시작 활성화</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>fastapi.service

<span class="c"># 부팅 시 자동 시작 비활성화</span>
<span class="nb">sudo </span>systemctl disable fastapi.service
</pre></td></tr></tbody></table></code></div></div> <p><strong>서비스 파일 수정 후:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 서비스 파일 수정</span>
<span class="nb">sudo </span>nano /etc/systemd/system/fastapi.service

<span class="c"># 변경사항 적용</span>
<span class="nb">sudo </span>systemctl daemon-reload

<span class="c"># 서비스 재시작</span>
<span class="nb">sudo </span>systemctl restart fastapi.service
</pre></td></tr></tbody></table></code></div></div> <h3 id="서비스-의존성-확인"><span class="me-2">서비스 의존성 확인</span><a href="#서비스-의존성-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># 서비스 의존성 트리</span>
systemctl list-dependencies fastapi.service

<span class="c"># 서비스 시작 순서</span>
systemd-analyze critical-chain fastapi.service
</pre></td></tr></tbody></table></code></div></div> <hr /> <h3 id="재부팅-테스트"><span class="me-2">재부팅 테스트</span><a href="#재부팅-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>시스템 재부팅 후 자동 시작 확인:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># 재부팅</span>
<span class="nb">sudo </span>reboot
</pre></td></tr></tbody></table></code></div></div> <p>재부팅 후 SSH 재접속 (약 1-2분 후):</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>ssh <span class="nt">-i</span> /경로/열쇠파일.pem ubuntu@인스턴스IP

<span class="c"># 서비스 상태 확인</span>
<span class="nb">sudo </span>systemctl status fastapi.service

<span class="c"># 서비스가 자동 시작되었는지 확인</span>
curl http://localhost:8000/health
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="환경-변수-관리"><span class="me-2">환경 변수 관리</span><a href="#환경-변수-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>환경 변수를 사용하여 민감한 정보와 설정을 코드에서 분리합니다.</p> <h3 id="env-파일-생성"><span class="me-2">.env 파일 생성</span><a href="#env-파일-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> /home/ubuntu/reactbase
nano .env
</pre></td></tr></tbody></table></code></div></div> <p><strong>.env 파일 내용:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c"># 환경 설정</span>
<span class="nv">ENVIRONMENT</span><span class="o">=</span>production
<span class="nv">DEBUG</span><span class="o">=</span>False

<span class="c"># 서버 설정</span>
<span class="nv">HOST</span><span class="o">=</span>0.0.0.0
<span class="nv">PORT</span><span class="o">=</span>8000
<span class="nv">WORKERS</span><span class="o">=</span>4

<span class="c"># 데이터베이스 (예시)</span>
<span class="nv">DATABASE_URL</span><span class="o">=</span>postgresql://user:password@localhost/dbname

<span class="c"># API 키 (예시)</span>
<span class="nv">SECRET_KEY</span><span class="o">=</span>your-secret-key-here-change-this
<span class="nv">API_KEY</span><span class="o">=</span>your-api-key-here

<span class="c"># CORS 설정</span>
<span class="nv">ALLOWED_ORIGINS</span><span class="o">=</span>https://yourdomain.com,https://www.yourdomain.com

<span class="c"># 로그 레벨</span>
<span class="nv">LOG_LEVEL</span><span class="o">=</span>info
</pre></td></tr></tbody></table></code></div></div> <h3 id="env-파일-권한-설정"><span class="me-2">.env 파일 권한 설정</span><a href="#env-파일-권한-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>민감한 정보 보호를 위해 권한 제한:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">chmod </span>600 /home/ubuntu/reactbase/.env
<span class="nb">chown </span>ubuntu:ubuntu /home/ubuntu/reactbase/.env
</pre></td></tr></tbody></table></code></div></div> <h3 id="fastapi-코드에서-환경-변수-사용"><span class="me-2">FastAPI 코드에서 환경 변수 사용</span><a href="#fastapi-코드에서-환경-변수-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>server.py 수정:</strong></p> <div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">()</span>

<span class="c1"># 환경 변수 읽기
</span><span class="n">ENVIRONMENT</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">"ENVIRONMENT"</span><span class="p">,</span> <span class="s">"development"</span><span class="p">)</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">"DEBUG"</span><span class="p">,</span> <span class="s">"False"</span><span class="p">)</span> <span class="o">==</span> <span class="s">"True"</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">"SECRET_KEY"</span><span class="p">,</span> <span class="s">"default-secret-key"</span><span class="p">)</span>
<span class="n">DATABASE_URL</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">"DATABASE_URL"</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s">"FastAPI Server"</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="n">DEBUG</span>
<span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/config"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_config</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">"environment"</span><span class="p">:</span> <span class="n">ENVIRONMENT</span><span class="p">,</span>
        <span class="s">"debug"</span><span class="p">:</span> <span class="n">DEBUG</span>
        <span class="c1"># SECRET_KEY는 노출하지 않음
</span>    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="systemd에서-환경-변수-사용"><span class="me-2">systemd에서 환경 변수 사용</span><a href="#systemd에서-환경-변수-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>systemd 서비스 파일에서 .env 로드:</p> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nn">[Service]</span>
<span class="py">EnvironmentFile</span><span class="p">=</span><span class="s">-/home/ubuntu/reactbase/.env</span>
</pre></td></tr></tbody></table></code></div></div> <p>또는 직접 환경 변수 설정:</p> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nn">[Service]</span>
<span class="py">Environment</span><span class="p">=</span><span class="s">"ENVIRONMENT=production"</span>
<span class="py">Environment</span><span class="p">=</span><span class="s">"DEBUG=False"</span>
<span class="py">Environment</span><span class="p">=</span><span class="s">"PORT=8000"</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="환경-변수-보안-best-practices"><span class="me-2">환경 변수 보안 Best Practices</span><a href="#환경-변수-보안-best-practices" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <ol> <li><strong>.env 파일을 Git에 커밋하지 않기</strong> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">".env"</span> <span class="o">&gt;&gt;</span> .gitignore
</pre></td></tr></tbody></table></code></div> </div> </li> <li><strong>.env.example 파일 제공</strong> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">cp</span> .env .env.example
<span class="c"># .env.example에서 실제 값 제거</span>
</pre></td></tr></tbody></table></code></div> </div> </li> <li><strong>최소 권한 원칙</strong> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">chmod </span>600 .env  <span class="c"># 소유자만 읽기/쓰기</span>
</pre></td></tr></tbody></table></code></div> </div> </li> <li><strong>암호화된 값 저장 (선택사항)</strong> <ul> <li>AWS Secrets Manager</li> <li>HashiCorp Vault</li> <li>환경 변수 암호화 도구</li> </ul> </li> </ol> <hr /> <h2 id="로그-관리-및-디버깅"><span class="me-2">로그 관리 및 디버깅</span><a href="#로그-관리-및-디버깅" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="journalctl을-사용한-로그-조회"><span class="me-2">journalctl을 사용한 로그 조회</span><a href="#journalctl을-사용한-로그-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>systemd 서비스 로그는 journald에 저장됩니다.</p> <p><strong>기본 로그 조회:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c"># 전체 로그</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service

<span class="c"># 최근 로그만 (tail)</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-n</span> 50

<span class="c"># 실시간 로그 (follow)</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-f</span>

<span class="c"># 오늘의 로그만</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">--since</span> today

<span class="c"># 특정 시간 이후</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">--since</span> <span class="s2">"2025-10-11 10:00:00"</span>

<span class="c"># 특정 시간 범위</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">--since</span> <span class="s2">"1 hour ago"</span> <span class="nt">--until</span> <span class="s2">"now"</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>로그 필터링:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 에러만 표시</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-p</span> err

<span class="c"># 경고 이상 (warning, error, critical)</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-p</span> warning

<span class="c"># 특정 문자열 검색</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service | <span class="nb">grep</span> <span class="s2">"ERROR"</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>로그 형식 옵션:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># JSON 형식</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-o</span> json

<span class="c"># 자세한 정보</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-o</span> verbose

<span class="c"># 한 줄로 표시</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-o</span> short
</pre></td></tr></tbody></table></code></div></div> <h3 id="로그-레벨-설정"><span class="me-2">로그 레벨 설정</span><a href="#로그-레벨-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>Uvicorn 로그 레벨:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c"># systemd 서비스 파일에서</span>
<span class="nv">ExecStart</span><span class="o">=</span>/home/ubuntu/reactbase/venv/bin/uvicorn server:app <span class="se">\</span>
    <span class="nt">--log-level</span> debug  <span class="c"># debug, info, warning, error, critical</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>Python logging 설정:</strong></p> <div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="c1"># 로그 설정
</span><span class="n">logging</span><span class="p">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span><span class="p">,</span>
    <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
        <span class="n">logging</span><span class="p">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s">'/var/log/fastapi/app.log'</span><span class="p">),</span>
        <span class="n">logging</span><span class="p">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/test"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Test endpoint called"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="s">"Debug information"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="s">"Warning message"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="s">"Error occurred"</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">"status"</span><span class="p">:</span> <span class="s">"ok"</span><span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="로그-로테이션"><span class="me-2">로그 로테이션</span><a href="#로그-로테이션" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>journald는 자동으로 로그를 로테이션하지만, 파일 로그를 사용하는 경우 logrotate 설정:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/logrotate.d/fastapi
</pre></td></tr></tbody></table></code></div></div> <p><strong>logrotate 설정:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>/var/log/fastapi/*.log {
    daily
    missingok
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 ubuntu ubuntu
    sharedscripts
    postrotate
        systemctl reload fastapi.service &gt; /dev/null 2&gt;&amp;1 || true
    endscript
}
</pre></td></tr></tbody></table></code></div></div> <p><strong>옵션 설명:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">daily</code>: 매일 로테이션</li> <li><code class="language-plaintext highlighter-rouge">rotate 14</code>: 14개 백업 유지</li> <li><code class="language-plaintext highlighter-rouge">compress</code>: 압축 저장</li> <li><code class="language-plaintext highlighter-rouge">delaycompress</code>: 다음 로테이션 때 압축</li> <li><code class="language-plaintext highlighter-rouge">notifempty</code>: 빈 로그 파일 무시</li> <li><code class="language-plaintext highlighter-rouge">create</code>: 새 로그 파일 권한</li> </ul> <p><strong>로테이션 테스트:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>logrotate <span class="nt">-f</span> /etc/logrotate.d/fastapi
</pre></td></tr></tbody></table></code></div></div> <h3 id="일반적인-오류-패턴-및-해결"><span class="me-2">일반적인 오류 패턴 및 해결</span><a href="#일반적인-오류-패턴-및-해결" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>1. 포트 이미 사용 중:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ERROR: [Errno 98] Address already in use
</pre></td></tr></tbody></table></code></div></div> <p>해결:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c"># 8000 포트 사용 중인 프로세스 찾기</span>
<span class="nb">sudo </span>lsof <span class="nt">-i</span> :8000
<span class="nb">sudo </span>netstat <span class="nt">-tulpn</span> | <span class="nb">grep</span> :8000

<span class="c"># 프로세스 종료</span>
<span class="nb">sudo kill</span> <span class="nt">-9</span> &lt;PID&gt;
</pre></td></tr></tbody></table></code></div></div> <p><strong>2. Permission denied:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>PermissionError: [Errno 13] Permission denied
</pre></td></tr></tbody></table></code></div></div> <p>해결:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c"># 파일/디렉터리 권한 확인</span>
<span class="nb">ls</span> <span class="nt">-la</span> /home/ubuntu/reactbase

<span class="c"># 권한 수정</span>
<span class="nb">sudo chown</span> <span class="nt">-R</span> ubuntu:ubuntu /home/ubuntu/reactbase
<span class="nb">chmod </span>755 /home/ubuntu/reactbase
</pre></td></tr></tbody></table></code></div></div> <p><strong>3. ModuleNotFoundError:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ModuleNotFoundError: No module named 'fastapi'
</pre></td></tr></tbody></table></code></div></div> <p>해결:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># 가상환경 활성화 확인</span>
<span class="nb">source</span> /home/ubuntu/reactbase/venv/bin/activate

<span class="c"># 패키지 재설치</span>
pip <span class="nb">install </span>fastapi uvicorn
</pre></td></tr></tbody></table></code></div></div> <p><strong>4. 서비스 시작 실패:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># 상세 로그 확인</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-xe</span>

<span class="c"># 서비스 파일 문법 확인</span>
systemd-analyze verify /etc/systemd/system/fastapi.service
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="nginx-리버스-프록시-설정"><span class="me-2">Nginx 리버스 프록시 설정</span><a href="#nginx-리버스-프록시-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>Nginx를 리버스 프록시로 사용하면 정적 파일 서빙, SSL 종료, 로드 밸런싱, 보안 향상 등의 이점을 얻을 수 있습니다.</p> <h3 id="nginx-설치"><span class="me-2">Nginx 설치</span><a href="#nginx-설치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> nginx
</pre></td></tr></tbody></table></code></div></div> <p><strong>Nginx 버전 확인:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>nginx <span class="nt">-v</span>
<span class="c"># 출력: nginx version: nginx/1.24.0 (Ubuntu)</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>Nginx 서비스 시작:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl start nginx
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>nginx
<span class="nb">sudo </span>systemctl status nginx
</pre></td></tr></tbody></table></code></div></div> <h3 id="nginx-설정-파일-생성"><span class="me-2">Nginx 설정 파일 생성</span><a href="#nginx-설정-파일-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>FastAPI 애플리케이션을 위한 Nginx 설정:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/nginx/sites-available/fastapi
</pre></td></tr></tbody></table></code></div></div> <p><strong>기본 설정 (HTTP):</strong></p> <div class="language-nginx highlighter-rouge"><div class="code-header"> <span data-label-text="Nginx"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">your-domain.com</span> <span class="s">www.your-domain.com</span><span class="p">;</span>  <span class="c1"># 또는 IP 주소</span>
    
    <span class="kn">client_max_body_size</span> <span class="mi">50M</span><span class="p">;</span>  <span class="c1"># 최대 요청 크기</span>
    
    <span class="c1"># 액세스 로그</span>
    <span class="kn">access_log</span> <span class="n">/var/log/nginx/fastapi_access.log</span><span class="p">;</span>
    <span class="kn">error_log</span> <span class="n">/var/log/nginx/fastapi_error.log</span><span class="p">;</span>
    
    <span class="c1"># FastAPI 프록시</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:8000</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-Proto</span> <span class="nv">$scheme</span><span class="p">;</span>
        
        <span class="c1"># WebSocket 지원</span>
        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Upgrade</span> <span class="nv">$http_upgrade</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Connection</span> <span class="s">"upgrade"</span><span class="p">;</span>
        
        <span class="c1"># 타임아웃 설정</span>
        <span class="kn">proxy_connect_timeout</span> <span class="s">60s</span><span class="p">;</span>
        <span class="kn">proxy_send_timeout</span> <span class="s">60s</span><span class="p">;</span>
        <span class="kn">proxy_read_timeout</span> <span class="s">60s</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1"># 정적 파일 직접 서빙 (성능 향상)</span>
    <span class="kn">location</span> <span class="n">/static/</span> <span class="p">{</span>
        <span class="kn">alias</span> <span class="n">/home/ubuntu/reactbase/public/</span><span class="p">;</span>
        <span class="kn">expires</span> <span class="s">30d</span><span class="p">;</span>
        <span class="kn">add_header</span> <span class="s">Cache-Control</span> <span class="s">"public,</span> <span class="s">immutable"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kn">location</span> <span class="n">/images/</span> <span class="p">{</span>
        <span class="kn">alias</span> <span class="n">/home/ubuntu/reactbase/public/</span><span class="p">;</span>
        <span class="kn">expires</span> <span class="s">30d</span><span class="p">;</span>
        <span class="kn">add_header</span> <span class="s">Cache-Control</span> <span class="s">"public,</span> <span class="s">immutable"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="nginx-설정-활성화"><span class="me-2">Nginx 설정 활성화</span><a href="#nginx-설정-활성화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># 심볼릭 링크 생성</span>
<span class="nb">sudo ln</span> <span class="nt">-s</span> /etc/nginx/sites-available/fastapi /etc/nginx/sites-enabled/

<span class="c"># 기본 사이트 비활성화 (선택사항)</span>
<span class="nb">sudo rm</span> /etc/nginx/sites-enabled/default

<span class="c"># 설정 문법 확인</span>
<span class="nb">sudo </span>nginx <span class="nt">-t</span>

<span class="c"># Nginx 재시작</span>
<span class="nb">sudo </span>systemctl reload nginx
</pre></td></tr></tbody></table></code></div></div> <h3 id="nginx-고급-설정"><span class="me-2">Nginx 고급 설정</span><a href="#nginx-고급-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>Gzip 압축 활성화:</strong></p> <p><code class="language-plaintext highlighter-rouge">/etc/nginx/nginx.conf</code> 편집:</p> <div class="language-nginx highlighter-rouge"><div class="code-header"> <span data-label-text="Nginx"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">http</span> <span class="p">{</span>
    <span class="c1"># Gzip 설정</span>
    <span class="kn">gzip</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">gzip_vary</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">gzip_proxied</span> <span class="s">any</span><span class="p">;</span>
    <span class="kn">gzip_comp_level</span> <span class="mi">6</span><span class="p">;</span>
    <span class="kn">gzip_types</span> <span class="nc">text/plain</span> <span class="nc">text/css</span> <span class="nc">text/xml</span> <span class="nc">text/javascript</span>
               <span class="nc">application/json</span> <span class="nc">application/javascript</span> <span class="nc">application/xml</span><span class="s">+rss</span>
               <span class="nc">application/rss</span><span class="s">+xml</span> <span class="nc">font/truetype</span> <span class="nc">font/opentype</span>
               <span class="nc">application/vnd</span><span class="s">.ms-fontobject</span> <span class="nc">image/svg</span><span class="s">+xml</span><span class="p">;</span>
    <span class="kn">gzip_disable</span> <span class="s">"msie6"</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>Rate Limiting (속도 제한):</strong></p> <div class="language-nginx highlighter-rouge"><div class="code-header"> <span data-label-text="Nginx"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="c1"># /etc/nginx/sites-available/fastapi</span>
<span class="k">http</span> <span class="p">{</span>
    <span class="c1"># Rate limit 존 정의</span>
    <span class="kn">limit_req_zone</span> <span class="nv">$binary_remote_addr</span> <span class="s">zone=api_limit:10m</span> <span class="s">rate=10r/s</span><span class="p">;</span>
    
    <span class="kn">server</span> <span class="p">{</span>
        <span class="c1"># ... 기존 설정 ...</span>
        
        <span class="kn">location</span> <span class="n">/api/</span> <span class="p">{</span>
            <span class="kn">limit_req</span> <span class="s">zone=api_limit</span> <span class="s">burst=20</span> <span class="s">nodelay</span><span class="p">;</span>
            <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:8000</span><span class="p">;</span>
            <span class="c1"># ... 프록시 설정 ...</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>보안 헤더 추가:</strong></p> <div class="language-nginx highlighter-rouge"><div class="code-header"> <span data-label-text="Nginx"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">server</span> <span class="p">{</span>
    <span class="c1"># ... 기존 설정 ...</span>
    
    <span class="c1"># 보안 헤더</span>
    <span class="kn">add_header</span> <span class="s">X-Frame-Options</span> <span class="s">"SAMEORIGIN"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">X-Content-Type-Options</span> <span class="s">"nosniff"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">X-XSS-Protection</span> <span class="s">"1</span><span class="p">;</span> <span class="kn">mode=block"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">Referrer-Policy</span> <span class="s">"no-referrer-when-downgrade"</span> <span class="s">always</span><span class="p">;</span>
    <span class="kn">add_header</span> <span class="s">Content-Security-Policy</span> <span class="s">"default-src</span> <span class="s">'self'</span> <span class="s">http:</span> <span class="s">https:</span> <span class="s">data:</span> <span class="s">blob:</span> <span class="s">'unsafe-inline'"</span> <span class="s">always</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="systemd-설정-수정"><span class="me-2">systemd 설정 수정</span><a href="#systemd-설정-수정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>Nginx를 사용하는 경우, FastAPI는 로컬호스트에서만 수신:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/systemd/system/fastapi.service
</pre></td></tr></tbody></table></code></div></div> <p><strong>ExecStart 수정:</strong></p> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="py">ExecStart</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase/venv/bin/uvicorn server:app </span><span class="se">\
</span>    <span class="s">--host 127.0.0.1 </span><span class="se">\ </span> <span class="c"># 127.0.0.1로 변경 (0.0.0.0에서)
</span>    <span class="s">--port 8000 </span><span class="se">\
</span>    <span class="s">--workers 4</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>서비스 재시작:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl daemon-reload
<span class="nb">sudo </span>systemctl restart fastapi.service
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="https-설정-lets-encrypt"><span class="me-2">HTTPS 설정 (Let’s Encrypt)</span><a href="#https-설정-lets-encrypt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>Let’s Encrypt를 사용하여 무료 SSL/TLS 인증서를 발급받고 HTTPS를 설정합니다.</p> <h3 id="사전-요구사항-1"><span class="me-2">사전 요구사항</span><a href="#사전-요구사항-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <ul> <li>도메인 이름 (DNS A 레코드가 EC2 IP를 가리켜야 함)</li> <li>80, 443 포트가 보안 그룹에서 열려 있어야 함</li> </ul> <h3 id="certbot-설치"><span class="me-2">Certbot 설치</span><a href="#certbot-설치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> certbot python3-certbot-nginx
</pre></td></tr></tbody></table></code></div></div> <h3 id="ssl-인증서-발급"><span class="me-2">SSL 인증서 발급</span><a href="#ssl-인증서-발급" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>자동 설정 (권장):</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>certbot <span class="nt">--nginx</span> <span class="nt">-d</span> your-domain.com <span class="nt">-d</span> www.your-domain.com
</pre></td></tr></tbody></table></code></div></div> <p><strong>프롬프트 응답:</strong></p> <ol> <li>이메일 주소 입력 (인증서 만료 알림용)</li> <li>이용 약관 동의 (Y)</li> <li>HTTPS로 리다이렉트 (권장: 2)</li> </ol> <p><strong>수동 설정:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># 인증서만 발급 (Nginx 설정은 수동)</span>
<span class="nb">sudo </span>certbot certonly <span class="nt">--nginx</span> <span class="nt">-d</span> your-domain.com <span class="nt">-d</span> www.your-domain.com
</pre></td></tr></tbody></table></code></div></div> <h3 id="nginx-https-설정"><span class="me-2">Nginx HTTPS 설정</span><a href="#nginx-https-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>Certbot이 자동으로 설정하지만, 수동 설정이 필요한 경우:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/nginx/sites-available/fastapi
</pre></td></tr></tbody></table></code></div></div> <p><strong>HTTPS 설정:</strong></p> <div class="language-nginx highlighter-rouge"><div class="code-header"> <span data-label-text="Nginx"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="rouge-code"><pre><span class="c1"># HTTP → HTTPS 리다이렉트</span>
<span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">listen</span> <span class="s">[::]:80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">your-domain.com</span> <span class="s">www.your-domain.com</span><span class="p">;</span>
    
    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># HTTPS 서버</span>
<span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">443</span> <span class="s">ssl</span> <span class="s">http2</span><span class="p">;</span>
    <span class="kn">listen</span> <span class="s">[::]:443</span> <span class="s">ssl</span> <span class="s">http2</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">your-domain.com</span> <span class="s">www.your-domain.com</span><span class="p">;</span>
    
    <span class="c1"># SSL 인증서</span>
    <span class="kn">ssl_certificate</span> <span class="n">/etc/letsencrypt/live/your-domain.com/fullchain.pem</span><span class="p">;</span>
    <span class="kn">ssl_certificate_key</span> <span class="n">/etc/letsencrypt/live/your-domain.com/privkey.pem</span><span class="p">;</span>
    <span class="kn">ssl_trusted_certificate</span> <span class="n">/etc/letsencrypt/live/your-domain.com/chain.pem</span><span class="p">;</span>
    
    <span class="c1"># SSL 설정 (Mozilla Intermediate 기준)</span>
    <span class="kn">ssl_protocols</span> <span class="s">TLSv1.2</span> <span class="s">TLSv1.3</span><span class="p">;</span>
    <span class="kn">ssl_ciphers</span> <span class="s">ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384</span><span class="p">;</span>
    <span class="kn">ssl_prefer_server_ciphers</span> <span class="no">off</span><span class="p">;</span>
    
    <span class="c1"># SSL 세션 캐시</span>
    <span class="kn">ssl_session_cache</span> <span class="s">shared:SSL:10m</span><span class="p">;</span>
    <span class="kn">ssl_session_timeout</span> <span class="mi">10m</span><span class="p">;</span>
    
    <span class="c1"># OCSP Stapling</span>
    <span class="kn">ssl_stapling</span> <span class="no">on</span><span class="p">;</span>
    <span class="kn">ssl_stapling_verify</span> <span class="no">on</span><span class="p">;</span>
    
    <span class="c1"># HSTS (HTTP Strict Transport Security)</span>
    <span class="kn">add_header</span> <span class="s">Strict-Transport-Security</span> <span class="s">"max-age=63072000</span><span class="p">;</span> <span class="kn">includeSubDomains</span><span class="p">;</span> <span class="kn">preload"</span> <span class="s">always</span><span class="p">;</span>
    
    <span class="c1"># 나머지 설정 (프록시, 정적 파일 등)</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:8000</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-Proto</span> <span class="nv">$scheme</span><span class="p">;</span>
        
        <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Upgrade</span> <span class="nv">$http_upgrade</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Connection</span> <span class="s">"upgrade"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kn">location</span> <span class="n">/static/</span> <span class="p">{</span>
        <span class="kn">alias</span> <span class="n">/home/ubuntu/reactbase/public/</span><span class="p">;</span>
        <span class="kn">expires</span> <span class="s">30d</span><span class="p">;</span>
        <span class="kn">add_header</span> <span class="s">Cache-Control</span> <span class="s">"public,</span> <span class="s">immutable"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>설정 적용:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nginx <span class="nt">-t</span>
<span class="nb">sudo </span>systemctl reload nginx
</pre></td></tr></tbody></table></code></div></div> <h3 id="인증서-자동-갱신"><span class="me-2">인증서 자동 갱신</span><a href="#인증서-자동-갱신" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>Let’s Encrypt 인증서는 90일마다 갱신이 필요합니다.</p> <p><strong>자동 갱신 테스트:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>certbot renew <span class="nt">--dry-run</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>자동 갱신 확인:</strong></p> <p>Certbot은 systemd 타이머로 자동 갱신이 설정됩니다:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># 타이머 상태 확인</span>
<span class="nb">sudo </span>systemctl status certbot.timer

<span class="c"># 갱신 스케줄 확인</span>
<span class="nb">sudo </span>systemctl list-timers | <span class="nb">grep </span>certbot
</pre></td></tr></tbody></table></code></div></div> <p><strong>수동 갱신:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>certbot renew
<span class="nb">sudo </span>systemctl reload nginx
</pre></td></tr></tbody></table></code></div></div> <h3 id="ssl-등급-테스트"><span class="me-2">SSL 등급 테스트</span><a href="#ssl-등급-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><a href="https://www.ssllabs.com/ssltest/">SSL Labs</a>에서 SSL 설정을 테스트하여 A+ 등급을 목표로 합니다.</p> <hr /> <h2 id="보안-강화"><span class="me-2">보안 강화</span><a href="#보안-강화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="ufw-방화벽-설정"><span class="me-2">UFW 방화벽 설정</span><a href="#ufw-방화벽-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>UFW(Uncomplicated Firewall)로 호스트 기반 방화벽을 설정합니다.</p> <p><strong>UFW 설치 및 활성화:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="c"># 기본 정책 설정</span>
<span class="nb">sudo </span>ufw default deny incoming
<span class="nb">sudo </span>ufw default allow outgoing

<span class="c"># SSH 허용 (연결 끊김 방지)</span>
<span class="nb">sudo </span>ufw allow 22/tcp
<span class="c"># 또는 특정 IP만</span>
<span class="nb">sudo </span>ufw allow from YOUR_IP_ADDRESS to any port 22

<span class="c"># HTTP/HTTPS 허용</span>
<span class="nb">sudo </span>ufw allow 80/tcp
<span class="nb">sudo </span>ufw allow 443/tcp

<span class="c"># UFW 활성화</span>
<span class="nb">sudo </span>ufw <span class="nb">enable</span>

<span class="c"># 상태 확인</span>
<span class="nb">sudo </span>ufw status verbose
</pre></td></tr></tbody></table></code></div></div> <p><strong>8000 포트 차단 (프로덕션):</strong></p> <p>Nginx를 사용하는 경우 FastAPI 포트를 외부에 노출하지 않습니다:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># 8000 포트는 로컬호스트에서만 접근 가능</span>
<span class="c"># UFW 규칙에 8000 포트 추가하지 않음</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="fail2ban-설정"><span class="me-2">Fail2ban 설정</span><a href="#fail2ban-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>SSH 무차별 대입 공격(Brute Force)을 방어합니다.</p> <p><strong>Fail2ban 설치:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> fail2ban
</pre></td></tr></tbody></table></code></div></div> <p><strong>설정 파일 생성:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/fail2ban/jail.local
</pre></td></tr></tbody></table></code></div></div> <p><strong>jail.local 내용:</strong></p> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="nn">[DEFAULT]</span>
<span class="py">bantime</span> <span class="p">=</span> <span class="s">3600  # 1시간 차단</span>
<span class="py">findtime</span> <span class="p">=</span> <span class="s">600  # 10분 내</span>
<span class="py">maxretry</span> <span class="p">=</span> <span class="s">5    # 5회 시도 실패 시 차단</span>

<span class="c"># SSH 보호
</span><span class="nn">[sshd]</span>
<span class="py">enabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">port</span> <span class="p">=</span> <span class="s">22</span>
<span class="py">logpath</span> <span class="p">=</span> <span class="s">/var/log/auth.log</span>

<span class="c"># Nginx 보호 (선택사항)
</span><span class="nn">[nginx-http-auth]</span>
<span class="py">enabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">port</span> <span class="p">=</span> <span class="s">http,https</span>
<span class="py">logpath</span> <span class="p">=</span> <span class="s">/var/log/nginx/error.log</span>

<span class="nn">[nginx-limit-req]</span>
<span class="py">enabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">port</span> <span class="p">=</span> <span class="s">http,https</span>
<span class="py">logpath</span> <span class="p">=</span> <span class="s">/var/log/nginx/error.log</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>Fail2ban 시작:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl <span class="nb">enable </span>fail2ban
<span class="nb">sudo </span>systemctl start fail2ban
<span class="nb">sudo </span>systemctl status fail2ban
</pre></td></tr></tbody></table></code></div></div> <p><strong>차단 상태 확인:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># 차단된 IP 확인</span>
<span class="nb">sudo </span>fail2ban-client status sshd

<span class="c"># 차단 해제</span>
<span class="nb">sudo </span>fail2ban-client <span class="nb">set </span>sshd unbanip &lt;IP_ADDRESS&gt;
</pre></td></tr></tbody></table></code></div></div> <h3 id="ssh-보안-강화"><span class="me-2">SSH 보안 강화</span><a href="#ssh-보안-강화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>SSH 설정 변경:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/ssh/sshd_config
</pre></td></tr></tbody></table></code></div></div> <p><strong>권장 설정:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre># 루트 로그인 비활성화
PermitRootLogin no

# 패스워드 인증 비활성화 (키 기반만 허용)
PasswordAuthentication no
PubkeyAuthentication yes

# 빈 패스워드 금지
PermitEmptyPasswords no

# X11 포워딩 비활성화 (필요없으면)
X11Forwarding no

# 접속 시도 제한
MaxAuthTries 3
MaxSessions 2

# 특정 사용자만 허용
AllowUsers ubuntu
</pre></td></tr></tbody></table></code></div></div> <p><strong>SSH 재시작:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart sshd
</pre></td></tr></tbody></table></code></div></div> <h3 id="자동-보안-업데이트"><span class="me-2">자동 보안 업데이트</span><a href="#자동-보안-업데이트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>Unattended-upgrades 설치:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> unattended-upgrades
</pre></td></tr></tbody></table></code></div></div> <p><strong>설정:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>dpkg-reconfigure <span class="nt">-plow</span> unattended-upgrades
<span class="c"># "Yes" 선택</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>설정 파일 확인:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/apt/apt.conf.d/50unattended-upgrades
</pre></td></tr></tbody></table></code></div></div> <p><strong>보안 업데이트만 자동 설치:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Unattended-Upgrade::Allowed-Origins {
    "${distro_id}:${distro_codename}-security";
};
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="성능-최적화"><span class="me-2">성능 최적화</span><a href="#성능-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="uvicorn-worker-최적화"><span class="me-2">Uvicorn Worker 최적화</span><a href="#uvicorn-worker-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>Worker 수 설정:</strong></p> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># /etc/systemd/system/fastapi.service
</span><span class="py">ExecStart</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase/venv/bin/uvicorn server:app </span><span class="se">\
</span>    <span class="s">--host 127.0.0.1 </span><span class="se">\
</span>    <span class="s">--port 8000 </span><span class="se">\
</span>    <span class="s">--workers 4  # CPU 코어 수 * 2 + 1</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>Worker 클래스 선택:</strong></p> <p>기본 Uvicorn worker는 단일 스레드입니다. 높은 동시성이 필요한 경우:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pip <span class="nb">install </span>gunicorn
</pre></td></tr></tbody></table></code></div></div> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c"># Gunicorn + Uvicorn workers
</span><span class="py">ExecStart</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase/venv/bin/gunicorn server:app </span><span class="se">\
</span>    <span class="s">--workers 4 </span><span class="se">\
</span>    <span class="s">--worker-class uvicorn.workers.UvicornWorker </span><span class="se">\
</span>    <span class="s">--bind 127.0.0.1:8000 </span><span class="se">\
</span>    <span class="s">--access-logfile /var/log/fastapi/access.log </span><span class="se">\
</span>    <span class="s">--error-logfile /var/log/fastapi/error.log</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="데이터베이스-연결-풀링"><span class="me-2">데이터베이스 연결 풀링</span><a href="#데이터베이스-연결-풀링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>데이터베이스를 사용하는 경우 연결 풀을 사용합니다:</p> <div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.pool</span> <span class="kn">import</span> <span class="n">QueuePool</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="n">DATABASE_URL</span><span class="p">,</span>
    <span class="n">poolclass</span><span class="o">=</span><span class="n">QueuePool</span><span class="p">,</span>
    <span class="n">pool_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">max_overflow</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">pool_pre_ping</span><span class="o">=</span><span class="bp">True</span>  <span class="c1"># 연결 유효성 검사
</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="캐싱-전략"><span class="me-2">캐싱 전략</span><a href="#캐싱-전략" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>Redis 캐싱 예시:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c"># Redis 설치</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> redis-server
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>redis-server
</pre></td></tr></tbody></table></code></div></div> <div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">redis</span> <span class="kn">import</span> <span class="n">Redis</span>
<span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
<span class="n">redis_client</span> <span class="o">=</span> <span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'localhost'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">decode_responses</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/cached-data"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_cached_data</span><span class="p">():</span>
    <span class="c1"># 캐시 확인
</span>    <span class="n">cached</span> <span class="o">=</span> <span class="n">redis_client</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"data_key"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">"data"</span><span class="p">:</span> <span class="n">cached</span><span class="p">,</span> <span class="s">"source"</span><span class="p">:</span> <span class="s">"cache"</span><span class="p">}</span>
    
    <span class="c1"># 데이터 조회 및 캐싱
</span>    <span class="n">data</span> <span class="o">=</span> <span class="n">expensive_operation</span><span class="p">()</span>
    <span class="n">redis_client</span><span class="p">.</span><span class="n">setex</span><span class="p">(</span><span class="s">"data_key"</span><span class="p">,</span> <span class="mi">3600</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>  <span class="c1"># 1시간 TTL
</span>    <span class="k">return</span> <span class="p">{</span><span class="s">"data"</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="s">"source"</span><span class="p">:</span> <span class="s">"database"</span><span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="정적-파일-최적화"><span class="me-2">정적 파일 최적화</span><a href="#정적-파일-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>Nginx에서 직접 서빙:</strong></p> <p>이미 위에서 설정한 것처럼 Nginx가 정적 파일을 직접 제공합니다.</p> <p><strong>Gzip 압축:</strong></p> <p>이미 Nginx에서 설정되었습니다.</p> <h3 id="메모리-및-cpu-모니터링"><span class="me-2">메모리 및 CPU 모니터링</span><a href="#메모리-및-cpu-모니터링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>시스템 리소스 확인:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="c"># CPU 및 메모리 사용량</span>
htop
<span class="c"># 또는</span>
top

<span class="c"># 프로세스별 메모리</span>
ps aux <span class="nt">--sort</span><span class="o">=</span>-%mem | <span class="nb">head</span> <span class="nt">-10</span>

<span class="c"># 디스크 사용량</span>
<span class="nb">df</span> <span class="nt">-h</span>

<span class="c"># 네트워크 연결</span>
netstat <span class="nt">-tulpn</span>
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="모니터링-및-유지보수"><span class="me-2">모니터링 및 유지보수</span><a href="#모니터링-및-유지보수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="시스템-모니터링-도구"><span class="me-2">시스템 모니터링 도구</span><a href="#시스템-모니터링-도구" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>htop 설치:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> htop
htop
</pre></td></tr></tbody></table></code></div></div> <p><strong>Prometheus + Grafana (고급):</strong></p> <p>프로덕션 환경에서 권장하는 모니터링 스택:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c"># Prometheus 설치</span>
wget https://github.com/prometheus/prometheus/releases/download/v2.45.0/prometheus-2.45.0.linux-amd64.tar.gz
<span class="nb">tar </span>xvfz prometheus-<span class="k">*</span>.tar.gz
<span class="nb">cd </span>prometheus-<span class="k">*</span>

<span class="c"># 설정 파일 작성</span>
nano prometheus.yml
</pre></td></tr></tbody></table></code></div></div> <p><strong>prometheus.yml:</strong></p> <div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="na">global</span><span class="pi">:</span>
  <span class="na">scrape_interval</span><span class="pi">:</span> <span class="s">15s</span>

<span class="na">scrape_configs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">fastapi'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">localhost:8000'</span><span class="pi">]</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="애플리케이션-헬스-체크"><span class="me-2">애플리케이션 헬스 체크</span><a href="#애플리케이션-헬스-체크" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>헬스 체크 엔드포인트 활용:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># 주기적으로 헬스 체크</span>
watch <span class="nt">-n</span> 5 curl <span class="nt">-s</span> http://localhost:8000/health
</pre></td></tr></tbody></table></code></div></div> <p><strong>Cron 작업으로 자동 모니터링:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>crontab <span class="nt">-e</span>
</pre></td></tr></tbody></table></code></div></div><pre><code class="language-cron"># 매 5분마다 헬스 체크
*/5 * * * * curl -sf http://localhost:8000/health || systemctl restart fastapi.service
</code></pre><h3 id="디스크-공간-모니터링"><span class="me-2">디스크 공간 모니터링</span><a href="#디스크-공간-모니터링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 디스크 사용량 확인</span>
<span class="nb">df</span> <span class="nt">-h</span>

<span class="c"># 큰 디렉터리 찾기</span>
<span class="nb">du</span> <span class="nt">-h</span> <span class="nt">--max-depth</span><span class="o">=</span>1 /home/ubuntu | <span class="nb">sort</span> <span class="nt">-hr</span>

<span class="c"># 로그 파일 크기 확인</span>
<span class="nb">du</span> <span class="nt">-sh</span> /var/log/<span class="k">*</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="백업-전략"><span class="me-2">백업 전략</span><a href="#백업-전략" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>데이터베이스 백업 (예시):</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># PostgreSQL 백업</span>
pg_dump dbname <span class="o">&gt;</span> backup_<span class="si">$(</span><span class="nb">date</span> +%Y%m%d<span class="si">)</span>.sql

<span class="c"># 백업 자동화 (cron)</span>
0 2 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> pg_dump dbname <span class="o">&gt;</span> /backup/db_<span class="si">$(</span><span class="nb">date</span> +<span class="se">\%</span>Y<span class="se">\%</span>m<span class="se">\%</span>d<span class="si">)</span>.sql
</pre></td></tr></tbody></table></code></div></div> <p><strong>애플리케이션 코드 백업:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c"># Git을 사용한 버전 관리</span>
<span class="nb">cd</span> /home/ubuntu/reactbase
git init
git add <span class="nb">.</span>
git commit <span class="nt">-m</span> <span class="s2">"Initial commit"</span>
git remote add origin &lt;your-repo-url&gt;
git push <span class="nt">-u</span> origin main
</pre></td></tr></tbody></table></code></div></div> <h3 id="업데이트-및-배포-전략"><span class="me-2">업데이트 및 배포 전략</span><a href="#업데이트-및-배포-전략" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>무중단 배포 (Blue-Green):</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c"># 새 버전 배포</span>
<span class="nb">cd</span> /home/ubuntu/reactbase
git pull origin main

<span class="c"># 의존성 업데이트</span>
<span class="nb">source </span>venv/bin/activate
pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt

<span class="c"># 서비스 재시작 (짧은 다운타임)</span>
<span class="nb">sudo </span>systemctl restart fastapi.service
</pre></td></tr></tbody></table></code></div></div> <p><strong>Graceful Reload:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># Gunicorn 사용 시</span>
<span class="nb">sudo </span>systemctl reload fastapi.service
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="vscode-sftp-설정"><span class="me-2">VSCode SFTP 설정</span><a href="#vscode-sftp-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>VSCode를 사용하면 로컬에서 수정한 파일을 자동으로 EC2로 업로드할 수 있습니다.</p> <h3 id="sftp-익스텐션-설치"><span class="me-2">SFTP 익스텐션 설치</span><a href="#sftp-익스텐션-설치" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <ol> <li>VSCode에서 Extensions 열기 (Ctrl+Shift+X)</li> <li>“SFTP” 검색 (Natizyskunk.sftp)</li> <li>설치</li> </ol> <h3 id="sftp-설정-파일-생성"><span class="me-2">SFTP 설정 파일 생성</span><a href="#sftp-설정-파일-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>프로젝트 루트에 <code class="language-plaintext highlighter-rouge">.vscode/sftp.json</code> 파일 생성:</p> <p><strong>Linux/macOS:</strong></p> <div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AWS FastAPI Server"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13.124.216.216"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sftp"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ubuntu"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"remotePath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/ubuntu/reactbase"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uploadOnSave"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"downloadOnOpen"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">".vscode"</span><span class="p">,</span><span class="w">
        </span><span class="s2">".git"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"venv"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"__pycache__"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"*.pyc"</span><span class="p">,</span><span class="w">
        </span><span class="s2">".env"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"privateKeyPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div> <p><strong>Windows:</strong></p> <div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AWS FastAPI Server"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13.124.216.216"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sftp"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ubuntu"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"remotePath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/ubuntu/reactbase"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uploadOnSave"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"downloadOnOpen"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">".vscode"</span><span class="p">,</span><span class="w">
        </span><span class="s2">".git"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"venv"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"__pycache__"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"*.pyc"</span><span class="p">,</span><span class="w">
        </span><span class="s2">".env"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"privateKeyPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">my</span><span class="se">\\\p</span><span class="s2">em</span><span class="se">\\</span><span class="s2">my_proton_key.pem"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div> <p><strong>중요 설정 옵션:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">uploadOnSave</code>: 파일 저장 시 자동 업로드</li> <li><code class="language-plaintext highlighter-rouge">downloadOnOpen</code>: 파일 열 때 서버에서 다운로드</li> <li><code class="language-plaintext highlighter-rouge">ignore</code>: 업로드 제외 파일/폴더</li> <li><code class="language-plaintext highlighter-rouge">privateKeyPath</code>: Windows에서는 <code class="language-plaintext highlighter-rouge">\\\\</code> 사용 (이스케이프)</li> </ul> <h3 id="sftp-사용법"><span class="me-2">SFTP 사용법</span><a href="#sftp-사용법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>파일 업로드:</strong></p> <ul> <li>파일 저장 시 자동 업로드 (uploadOnSave: true)</li> <li>수동 업로드: F1 → “SFTP: Upload” 선택</li> </ul> <p><strong>폴더 동기화:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>F1 → "SFTP: Sync Local -&gt; Remote"
F1 → "SFTP: Sync Remote -&gt; Local"
</pre></td></tr></tbody></table></code></div></div> <p><strong>서버 파일 직접 편집:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>F1 → "SFTP: List"
파일 선택 → 편집
</pre></td></tr></tbody></table></code></div></div> <h3 id="배포-후-서비스-재시작"><span class="me-2">배포 후 서비스 재시작</span><a href="#배포-후-서비스-재시작" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p>파일 업로드 후 서버에서:</p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># SSH 접속</span>
ssh aws-fastapi

<span class="c"># 서비스 재시작</span>
<span class="nb">sudo </span>systemctl restart fastapi.service

<span class="c"># 로그 확인</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-f</span>
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="트러블슈팅"><span class="me-2">트러블슈팅</span><a href="#트러블슈팅" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="포트-접속-불가-문제"><span class="me-2">포트 접속 불가 문제</span><a href="#포트-접속-불가-문제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>증상:</strong> 브라우저에서 <code class="language-plaintext highlighter-rouge">http://인스턴스IP:8000</code> 접속 불가</p> <p><strong>진단 단계:</strong></p> <ol> <li><strong>서비스 실행 확인:</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl status fastapi.service
ps aux | <span class="nb">grep </span>uvicorn
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>포트 리스닝 확인:</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>netstat <span class="nt">-tulpn</span> | <span class="nb">grep</span> :8000
<span class="c"># 또는</span>
<span class="nb">sudo </span>ss <span class="nt">-tulpn</span> | <span class="nb">grep</span> :8000
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>로컬호스트 접근 테스트:</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>curl http://localhost:8000
curl http://127.0.0.1:8000
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>AWS 보안 그룹 확인:</strong></li> </ol> <p>EC2 Console → 보안 그룹 → 인바운드 규칙에 8000 포트 있는지 확인</p> <ol> <li><strong>UFW 방화벽 확인:</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>ufw status
<span class="c"># 8000 포트가 허용되어 있는지 확인</span>
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>ISP 방화벽 문제:</strong></li> </ol> <p>집 인터넷에서 안 되면 <strong>휴대폰 핫스팟</strong>으로 시도</p> <p><strong>해결 방법:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c"># 보안 그룹에 8000 포트 추가</span>
<span class="c"># UFW 허용 (필요한 경우)</span>
<span class="nb">sudo </span>ufw allow 8000/tcp

<span class="c"># 서비스 재시작</span>
<span class="nb">sudo </span>systemctl restart fastapi.service
</pre></td></tr></tbody></table></code></div></div> <h3 id="systemd-서비스-실행-실패"><span class="me-2">systemd 서비스 실행 실패</span><a href="#systemd-서비스-실행-실패" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>증상:</strong> <code class="language-plaintext highlighter-rouge">sudo systemctl start fastapi.service</code> 실패</p> <p><strong>진단:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c"># 상세 로그 확인</span>
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> fastapi.service <span class="nt">-xe</span>

<span class="c"># 서비스 파일 문법 확인</span>
systemd-analyze verify /etc/systemd/system/fastapi.service

<span class="c"># 수동 실행 테스트</span>
<span class="nb">cd</span> /home/ubuntu/reactbase
<span class="nb">source </span>venv/bin/activate
python3 server.py
</pre></td></tr></tbody></table></code></div></div> <p><strong>일반적인 원인:</strong></p> <ol> <li><strong>가상환경 경로 오류:</strong></li> </ol> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c"># 경로 확인
</span><span class="py">Environment</span><span class="p">=</span><span class="s">"PATH=/home/ubuntu/reactbase/venv/bin"</span>
<span class="py">ExecStart</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase/venv/bin/uvicorn server:app</span>
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>파일 권한 문제:</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo chown</span> <span class="nt">-R</span> ubuntu:ubuntu /home/ubuntu/reactbase
<span class="nb">chmod </span>755 /home/ubuntu/reactbase
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>모듈 누락:</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">source </span>venv/bin/activate
pip <span class="nb">install </span>fastapi uvicorn
</pre></td></tr></tbody></table></code></div></div> <h3 id="permission-denied-오류"><span class="me-2">Permission Denied 오류</span><a href="#permission-denied-오류" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>증상:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>PermissionError: [Errno 13] Permission denied: '/some/path'
</pre></td></tr></tbody></table></code></div></div> <p><strong>해결:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c"># 디렉터리 소유자 확인</span>
<span class="nb">ls</span> <span class="nt">-la</span> /home/ubuntu/reactbase

<span class="c"># 소유자 변경</span>
<span class="nb">sudo chown</span> <span class="nt">-R</span> ubuntu:ubuntu /home/ubuntu/reactbase

<span class="c"># 권한 설정</span>
<span class="nb">chmod </span>755 /home/ubuntu/reactbase
<span class="nb">chmod </span>644 /home/ubuntu/reactbase/server.py
<span class="nb">chmod </span>600 /home/ubuntu/reactbase/.env
</pre></td></tr></tbody></table></code></div></div> <h3 id="메모리-부족-문제"><span class="me-2">메모리 부족 문제</span><a href="#메모리-부족-문제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>증상:</strong> 서버가 자주 재시작되거나 응답이 느림</p> <p><strong>진단:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># 메모리 사용량 확인</span>
free <span class="nt">-h</span>

<span class="c"># 프로세스별 메모리</span>
ps aux <span class="nt">--sort</span><span class="o">=</span>-%mem | <span class="nb">head</span> <span class="nt">-10</span>

<span class="c"># OOM (Out of Memory) 로그 확인</span>
dmesg | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"out of memory"</span>
<span class="nb">sudo </span>journalctl <span class="nt">-k</span> | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"killed process"</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>해결:</strong></p> <ol> <li><strong>Worker 수 줄이기:</strong></li> </ol> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c"># /etc/systemd/system/fastapi.service
</span><span class="py">ExecStart</span><span class="p">=</span><span class="s">/home/ubuntu/reactbase/venv/bin/uvicorn server:app </span><span class="se">\
</span>    <span class="s">--workers 2  # 줄임</span>
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>스왑 메모리 추가:</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># 1GB 스왑 생성</span>
<span class="nb">sudo </span>fallocate <span class="nt">-l</span> 1G /swapfile
<span class="nb">sudo chmod </span>600 /swapfile
<span class="nb">sudo </span>mkswap /swapfile
<span class="nb">sudo </span>swapon /swapfile

<span class="c"># 영구 설정</span>
<span class="nb">echo</span> <span class="s1">'/swapfile none swap sw 0 0'</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/fstab

<span class="c"># 확인</span>
free <span class="nt">-h</span>
</pre></td></tr></tbody></table></code></div></div> <ol> <li><strong>인스턴스 업그레이드:</strong> t2.micro → t2.small</li> </ol> <h3 id="네트워크-타임아웃"><span class="me-2">네트워크 타임아웃</span><a href="#네트워크-타임아웃" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>증상:</strong> 요청이 느리거나 타임아웃</p> <p><strong>해결:</strong></p> <div class="language-nginx highlighter-rouge"><div class="code-header"> <span data-label-text="Nginx"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1"># Nginx 타임아웃 증가</span>
<span class="k">location</span> <span class="n">/</span> <span class="p">{</span>
    <span class="kn">proxy_connect_timeout</span> <span class="s">120s</span><span class="p">;</span>
    <span class="kn">proxy_send_timeout</span> <span class="s">120s</span><span class="p">;</span>
    <span class="kn">proxy_read_timeout</span> <span class="s">120s</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <div class="language-ini highlighter-rouge"><div class="code-header"> <span data-label-text="Ini"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c"># systemd 타임아웃
</span><span class="nn">[Service]</span>
<span class="py">TimeoutStartSec</span><span class="p">=</span><span class="s">120</span>
<span class="py">TimeoutStopSec</span><span class="p">=</span><span class="s">120</span>
</pre></td></tr></tbody></table></code></div></div> <h3 id="sftp-연결-문제"><span class="me-2">SFTP 연결 문제</span><a href="#sftp-연결-문제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>Windows에서 privateKeyPath 오류:</strong></p> <div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"privateKeyPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">my</span><span class="se">\\\p</span><span class="s2">em</span><span class="se">\\</span><span class="s2">my_proton_key.pem"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div> <p><strong>키 권한 오류:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c"># Linux/macOS</span>
<span class="nb">chmod </span>400 /path/to/key.pem

<span class="c"># Windows PowerShell</span>
icacls <span class="s2">"C:</span><span class="se">\p</span><span class="s2">ath</span><span class="se">\t</span><span class="s2">o</span><span class="se">\k</span><span class="s2">ey.pem"</span> /inheritance:r
icacls <span class="s2">"C:</span><span class="se">\p</span><span class="s2">ath</span><span class="se">\t</span><span class="s2">o</span><span class="se">\k</span><span class="s2">ey.pem"</span> /grant:r <span class="s2">"%USERNAME%:R"</span>
</pre></td></tr></tbody></table></code></div></div> <p><strong>연결 테스트:</strong></p> <div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># 터미널에서 SFTP 테스트</span>
sftp <span class="nt">-i</span> /path/to/key.pem ubuntu@&lt;IP&gt;
</pre></td></tr></tbody></table></code></div></div> <hr /> <h2 id="참고-자료"><span class="me-2">참고 자료</span><a href="#참고-자료" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <h3 id="공식-문서"><span class="me-2">공식 문서</span><a href="#공식-문서" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <p><strong>FastAPI:</strong></p> <ul> <li><a href="https://fastapi.tiangolo.com/">FastAPI 공식 문서</a></li> <li><a href="https://fastapi.tiangolo.com/deployment/">FastAPI 배포 가이드</a></li> <li><a href="https://www.uvicorn.org/">Uvicorn 문서</a></li> </ul> <p><strong>AWS:</strong></p> <ul> <li><a href="https://docs.aws.amazon.com/ec2/">EC2 사용 설명서</a></li> <li><a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">보안 그룹 규칙</a></li> <li><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html">Elastic IP 주소</a></li> </ul> <p><strong>Nginx:</strong></p> <ul> <li><a href="https://nginx.org/en/docs/">Nginx 공식 문서</a></li> <li><a href="https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/">Nginx 리버스 프록시 가이드</a></li> </ul> <p><strong>Let’s Encrypt:</strong></p> <ul> <li><a href="https://certbot.eff.org/">Certbot 문서</a></li> <li><a href="https://letsencrypt.org/docs/">Let’s Encrypt 문서</a></li> </ul> <p><strong>systemd:</strong></p> <ul> <li><a href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">systemd 서비스 단위 파일</a></li> <li><a href="https://www.freedesktop.org/software/systemd/man/systemd.unit.html">systemd 예제</a></li> </ul> <h3 id="보안-best-practices"><span class="me-2">보안 Best Practices</span><a href="#보안-best-practices" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <ul> <li><a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a></li> <li><a href="https://ssl-config.mozilla.org/">Mozilla SSL Configuration Generator</a></li> <li><a href="https://www.cisecurity.org/benchmark/ubuntu_linux">CIS Ubuntu Benchmark</a></li> </ul> <h3 id="성능-최적화-1"><span class="me-2">성능 최적화</span><a href="#성능-최적화-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <ul> <li><a href="https://fastapi.tiangolo.com/advanced/performance/">FastAPI 성능 팁</a></li> <li><a href="https://www.uvicorn.org/deployment/">Uvicorn 프로덕션 배포</a></li> <li><a href="https://www.nginx.com/blog/tuning-nginx/">Nginx 성능 튜닝</a></li> </ul> <h3 id="모니터링-도구"><span class="me-2">모니터링 도구</span><a href="#모니터링-도구" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <ul> <li><a href="https://prometheus.io/">Prometheus</a></li> <li><a href="https://grafana.com/">Grafana</a></li> <li><a href="https://www.netdata.cloud/">Netdata</a></li> <li><a href="https://aws.amazon.com/cloudwatch/">CloudWatch (AWS)</a></li> </ul> <h3 id="커뮤니티"><span class="me-2">커뮤니티</span><a href="#커뮤니티" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3> <ul> <li><a href="https://github.com/tiangolo/fastapi">FastAPI GitHub</a></li> <li><a href="https://discord.com/invite/VQjSZaeJmf">FastAPI Discord</a></li> <li><a href="https://stackoverflow.com/questions/tagged/fastapi">Stack Overflow - FastAPI 태그</a></li> </ul> <hr /> <h2 id="마무리"><span class="me-2">마무리</span><a href="#마무리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>이 문서는 AWS EC2에서 FastAPI 애플리케이션을 프로덕션 수준으로 배포하는 완전한 가이드를 제공합니다.</p> <p><strong>핵심 단계 요약:</strong></p> <ol> <li><strong>인프라 설정</strong>: EC2 인스턴스 생성 및 보안 그룹 구성</li> <li><strong>애플리케이션 배포</strong>: Python 환경 설정 및 FastAPI 설치</li> <li><strong>프로세스 관리</strong>: systemd를 통한 자동 실행 및 관리</li> <li><strong>리버스 프록시</strong>: Nginx를 통한 트래픽 라우팅 및 최적화</li> <li><strong>보안 강화</strong>: HTTPS, 방화벽, Fail2ban 설정</li> <li><strong>성능 최적화</strong>: Worker 설정, 캐싱, 리소스 모니터링</li> <li><strong>지속적 관리</strong>: 로그 관리, 백업, 업데이트 전략</li> </ol> <p><strong>프로덕션 체크리스트:</strong></p> <ul class="task-list"> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>systemd 자동 실행 설정</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Nginx 리버스 프록시 구성</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>HTTPS/SSL 인증서 설정</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>UFW 방화벽 활성화</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Fail2ban SSH 보호</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>로그 로테이션 설정</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>헬스 체크 엔드포인트 구현</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>모니터링 도구 설치</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>백업 전략 수립</li> <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>자동 보안 업데이트 활성화</li> </ul> <p>이제 여러분의 FastAPI 서버는 안정적이고 안전하며 확장 가능한 프로덕션 환경에서 실행됩니다.</p> <p><strong>추가 개선 사항:</strong></p> <ul> <li>CI/CD 파이프라인 구축 (GitHub Actions, GitLab CI)</li> <li>컨테이너화 (Docker, Docker Compose)</li> <li>오케스트레이션 (Kubernetes, ECS)</li> <li>로드 밸런서 구성 (Application Load Balancer)</li> <li>데이터베이스 분리 (RDS, Aurora)</li> <li>CDN 활용 (CloudFront)</li> <li>서버리스 옵션 (Lambda + API Gateway)</li> </ul> <p>행운을 빕니다!</p> </div> <div class="post-tail-wrapper text-muted"> <!-- categories --> <div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/my-blog/categories/learning/">Learning</a> </div> <!-- tags --> <div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/my-blog/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/my-blog/tags/fastapi/" class="post-tag no-text-decoration" >fastapi</a> <a href="/my-blog/tags/ec2/" class="post-tag no-text-decoration" >ec2</a> <a href="/my-blog/tags/ubuntu/" class="post-tag no-text-decoration" >ubuntu</a> <a href="/my-blog/tags/systemd/" class="post-tag no-text-decoration" >systemd</a> <a href="/my-blog/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/my-blog/tags/nginx/" class="post-tag no-text-decoration" >nginx</a> <a href="/my-blog/tags/https/" class="post-tag no-text-decoration" >https</a> <a href="/my-blog/tags/devops/" class="post-tag no-text-decoration" >devops</a> </div> <div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " > <div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다. </div> <!-- Post sharing snippet --> <div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AWS%20EC2%20FastAPI%20%ED%94%84%EB%A1%9C%EB%8D%95%EC%85%98%20%EB%B0%B0%ED%8F%AC%20%EC%99%84%EC%A0%84%20%EA%B0%80%EC%9D%B4%EB%93%9C%20-%20%EC%A0%95%ED%98%84%EB%A5%98%EC%9D%98%20%EA%B0%9C%EB%B0%9C%20%EB%B8%94%EB%A1%9C%EA%B7%B8&url=http%3A%2F%2Flocalhost%3A4000%2Fmy-blog%2Fposts%2Fstudy-aws%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fmy-blog%2Fposts%2Fstudy-aws%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A4000%2Fmy-blog%2Fposts%2Fstudy-aws%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="LinkedIn" aria-label="LinkedIn"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span> </div> </div> <!-- .post-tail-bottom --> </div> <!-- div.post-tail-wrapper --> </article> </main> <!-- panel --> <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"> <div class="access"> <!-- Get 5 last posted/updated posts --> <section id="access-lastmod"> <h2 class="panel-heading">최근 업데이트</h2> <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"> <li class="text-truncate lh-lg"> <a href="/my-blog/posts/wi-fi/">Wi-Fi 속도가 빠를수록 품질이 나빠지는 이유 ⭐⭐⭐</a> </li> <li class="text-truncate lh-lg"> <a href="/my-blog/posts/geeknews/">“튜토리얼 지옥”을 대체한 “바이브 코딩 지옥”의 등장 ⭐⭐⭐</a> </li> <li class="text-truncate lh-lg"> <a href="/my-blog/posts/ec2-nginx-applcation/">EC2 서버에 Nginx와 Application Server(uvicorn/FastAPI) 연결 설정, 운영 팁까지</a> </li> <li class="text-truncate lh-lg"> <a href="/my-blog/posts/study-aws/">AWS EC2 FastAPI 프로덕션 배포 완전 가이드</a> </li> <li class="text-truncate lh-lg"> <a href="/my-blog/posts/reddit-2350/">경쟁자가 Reddit 모더레이터가 되어 2,350만 달러 부트캠프를 무너뜨린 사건</a> </li> </ul> </section> <!-- #access-lastmod --> <!-- The trending tags list --> <section> <h2 class="panel-heading">인기 태그</h2> <div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/food/">food</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/ec2/">ec2</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/ubuntu/">ubuntu</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/cooking/">cooking</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/qa/">qa</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/quality-assurance/">quality-assurance</a> </div> </section> </div> <div class="toc-border-cover z-3"></div> <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"> <h2 class="panel-heading ps-3 pb-2 mb-0">바로가기</h2> <nav id="toc"></nav> </section> </aside> </div> <div class="row"> <!-- tail --> <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post. --> <!-- The total size of related posts --> <!-- An random integer that bigger than 0 --> <!-- Equals to TAG_SCORE / {max_categories_hierarchy} --> <aside id="related-posts" aria-labelledby="related-label"> <h3 class="mb-4" id="related-label">관련된 글</h3> <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"> <article class="col"> <a href="/my-blog/posts/ec2-nginx-applcation/" class="post-preview card h-100"> <div class="card-body"> <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <time data-ts="1760241900" data-df="YYYY/MM/DD" > 2025/10/12 </time> <h4 class="pt-0 my-2">EC2 서버에 Nginx와 Application Server(uvicorn/FastAPI) 연결 설정, 운영 팁까지</h4> <div class="text-muted"> <p>AWS EC2에서 Nginx와 FastAPI 애플리케이션 서버를 연결 설정하고 운영하는 방법</p> </div> </div> </a> </article> <article class="col"> <a href="/my-blog/posts/qa-organizations-shift-left-strategy-integration/" class="post-preview card h-100"> <div class="card-body"> <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <time data-ts="1758267545" data-df="YYYY/MM/DD" > 2025/09/19 </time> <h4 class="pt-0 my-2">QA 조직의 Shift-Left 전략과 개발·운영 파이프라인 통합</h4> <div class="text-muted"> <p>QA 조직의 Shift-Left 전략과 개발·운영 파이프라인 통합에 대한 깊이 있는 분석과 실무적 고려사항을 제공합니다.</p> </div> </div> </a> </article> <article class="col"> <a href="/my-blog/posts/latest-trend-startup-ideas/" class="post-preview card h-100"> <div class="card-body"> <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <time data-ts="1758755889" data-df="YYYY/MM/DD" > 2025/09/25 </time> <h4 class="pt-0 my-2">최신 트렌드 기반 스타트업 아이디어</h4> <div class="text-muted"> <p>최신 트렌드를 기반으로 한 혁신적인 스타트업 아이디어 모음</p> </div> </div> </a> </article> </nav> </aside> <!-- #related-posts --> <!-- Navigation buttons at the bottom of the post. --> <nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/my-blog/posts/reddit-2350/" class="btn btn-outline-primary" aria-label="이전 글" > <p>경쟁자가 Reddit 모더레이터가 되어 2,350만 달러 부트캠프를 무너뜨린 사건</p> </a> <a href="/my-blog/posts/ec2-nginx-applcation/" class="btn btn-outline-primary" aria-label="다음 글" > <p>EC2 서버에 Nginx와 Application Server(uvicorn/FastAPI) 연결 설정, 운영 팁까지</p> </a> </nav> <!-- The Footer --> <footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " > <p>© <time>2025</time> <a href="https://github.com/junghyunryu">정현류</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다." >일부 권리 보유</span> </p> <p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme </p> </footer> </div> </div> <!-- The Search results --> <div id="search-result-wrapper" class="d-flex justify-content-center d-none"> <div class="col-11 content"> <div id="search-hints"> <!-- The trending tags list --> <section> <h2 class="panel-heading">인기 태그</h2> <div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/food/">food</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/ec2/">ec2</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/ubuntu/">ubuntu</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/cooking/">cooking</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/python/">python</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/qa/">qa</a> <a class="post-tag btn btn-outline-primary" href="/my-blog/tags/quality-assurance/">quality-assurance</a> </div> </section> </div> <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div> </div> </div> </div> <aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button> </aside> </div> <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div> <!-- Embedded scripts --> <!-- The comments switcher --> <!-- Jekyll Simple Search loader See: <https://github.com/christian-fei/Simple-Jekyll-Search> --> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/my-blog/assets/js/data/search.json', searchResultTemplate: ' <article class="px-1 px-sm-2 px-lg-4 px-xl-0"> <header> <h2><a href="{url}">{title}</a></h2> <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags} </div> </header> <p>{content}</p> </article>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script> </body> </html>
